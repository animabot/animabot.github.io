<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ANIMA: nyul_hist_normalization.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ANIMA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5ce0a585544ccf90f6c4541b827e0dfc.html">anima-nightly-src</a></li><li class="navelem"><a class="el" href="dir_0fad36fe10bbcca9e7c6f0593f8115a7.html">filtering</a></li><li class="navelem"><a class="el" href="dir_a8c965e58a3e16f0722aea8ebc1f2ff0.html">nyul_standardization</a></li><li class="navelem"><a class="el" href="dir_369872ed032a3cd8f5543300e1c0f96c.html">matlab_intensity_standardization</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">nyul_hist_normalization.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="nyul__hist__normalization_8m.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;%</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;% A.Crimi 18.01.2012</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;% Histogram standardization Nyul et al. 2000</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;% The general idea is to strech <a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> <a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a> histogram according to the mode <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;% shoulder of <a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> <span class="keyword">template</span> histogram.</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;%</div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a2aab5d576d87bc08a721fe1cbeab0236">    8</a></span>&#160;% MRI data is <a class="code" href="nyul__hist__normalization_8m.html#a2aab5d576d87bc08a721fe1cbeab0236">multimodale</a>, set the mode <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> shoulder to use <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> the</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;% WhiteMatter mode.</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;%</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;% Histogram standardization of Volume</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">function</span> <a class="code" href="nyul__hist__normalization_8m.html#aa1e625dc7dab253ffa4aef21f1a68c07">nyul_hist_normalization</a>( file_name_template, file_name_moving, file_mask_template , file_mask_moving )</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;% Parameter <span class="keywordflow">for</span> removing background values <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a> outlier</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;%These are common <a class="code" href="nyul__hist__normalization_8m.html#a5c2f5cf403c7bb3b255cec9577b4e465">sensible</a> values</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;max_value =  255;</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">   19</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">max_background_value</a> = 1; %Assume <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> the background values are 0 or 1</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a9614fa52c618a1b02bde3c390d7137b6">   20</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a9614fa52c618a1b02bde3c390d7137b6">min_noise_value</a> =  254; %Assume <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> the <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a> has values of 254 <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> 255</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;%Histogram dependent  parameters set by users. Not critical</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a6c6a302e257e1a23d0671bc6ee3f94f9">   22</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a6c6a302e257e1a23d0671bc6ee3f94f9">p1j</a> = 0; % left shoulder mode background <span class="keyword">template</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#ab3d7170ac42bb69d2d4921867523a104">   23</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#ab3d7170ac42bb69d2d4921867523a104">p1i</a> = 0; % left shoulder mode background <a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">   24</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">s1</a> = 1; % absolute min value </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a5c2f5cf403c7bb3b255cec9577b4e465">   25</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a7cfc0f10b3c9243718d965fd3e229f54">s2</a> = max_value;% 255; % absolute max value</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;% DATA DEPENDENT PARAMENTER!!!!</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;% Not extremely critical but they need to be <a class="code" href="nyul__hist__normalization_8m.html#a5c2f5cf403c7bb3b255cec9577b4e465">sensible</a>, the data are</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;% normalized between 0 <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> 255,therefore these values should be always fine</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a4c5667bb1bab250339f9858b6e2e5268">   29</a></span>&#160;%<a class="code" href="nyul__hist__normalization_8m.html#a9164ee040b2d05f08dc562788b20ad0b">p2j</a> = 253; %right shoulder mode foreground <span class="keyword">template</span>, it is some sort of measurement of the variance</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">   30</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a0396bc795783c332d98bc9a65e2275dd">p2i</a> = <a class="code" href="nyul__hist__normalization_8m.html#a9614fa52c618a1b02bde3c390d7137b6">min_noise_value</a> -1; % 248; %right shoulder mode foreground <a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>, it is some sort of measurement of the variance</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;%Load MASK Nifti-file</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;mask_template = <a class="code" href="nyul__hist__normalization_8m.html#a025c4feb9db701a892ecb8f172e01ffb">load_untouch_nii</a>(file_mask_template);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;%Load Nifti-file</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a4c5667bb1bab250339f9858b6e2e5268">template</a>  = <a class="code" href="nyul__hist__normalization_8m.html#a025c4feb9db701a892ecb8f172e01ffb">load_untouch_nii</a>(file_name_template);</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#aa9440f791ebae83f1318b83aed3cd178">   36</a></span>&#160;<span class="keyword">template</span>.img = <a class="code" href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a>(<span class="keyword">template</span>.<a class="code" href="nyul__hist__normalization_8m.html#aa9440f791ebae83f1318b83aed3cd178">img</a>) .*  <a class="code" href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a>(mask_template.img);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;[a b c] = size(<span class="keyword">template</span>.<a class="code" href="nyul__hist__normalization_8m.html#aa9440f791ebae83f1318b83aed3cd178">img</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">   39</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> = reshape(<span class="keyword">template</span>.<a class="code" href="nyul__hist__normalization_8m.html#aa9440f791ebae83f1318b83aed3cd178">img</a>,1,<a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a>*b*<a class="code" href="reslice__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>);      </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> = max_value * (<a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> - min(<a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>) )/( max(<a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>) - min(<a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>)); %<a class="code" href="namespaceanima.html#a75307a7eb3fa0266ae6134d2c65dba63">Normalize</a> between 0 <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> 256</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a342262936bbc8720d9d9afadfbf10e7a">   41</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a342262936bbc8720d9d9afadfbf10e7a">converted_data_s</a> = <a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#aa82e6383b921cf10c8e48000127ff7dc">   42</a></span>&#160;%<a class="code" href="nyul__hist__normalization_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a>;<a class="code" href="nyul__hist__normalization_8m.html#ae7b9eccc00b2a0a6017140677e100eaf">hist</a>(<a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>,max_value); %Histogram without any processing</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;%Remove background <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> outliers</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#ab9a48810d2822c2d15b7355abd232e4c">   44</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a> = find( <a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> &gt; <a class="code" href="nyul__hist__normalization_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">max_background_value</a> &amp; <a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> &lt; <a class="code" href="nyul__hist__normalization_8m.html#a9614fa52c618a1b02bde3c390d7137b6">min_noise_value</a> );</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a42e7bb345661535df7bd5e3137f988f2">   45</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a> = <a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>(<a class="code" href="nyul__hist__normalization_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a>);%</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;%<a class="code" href="nyul__hist__normalization_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a>; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;%<a class="code" href="nyul__hist__normalization_8m.html#ae7b9eccc00b2a0a6017140677e100eaf">hist</a>(<a class="code" href="nyul__hist__normalization_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a>,max_value);</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a88fd2e6e6c004e106a2981e2019af28e">   48</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a88fd2e6e6c004e106a2981e2019af28e">template_hist</a> = <a class="code" href="nyul__hist__normalization_8m.html#ae7b9eccc00b2a0a6017140677e100eaf">hist</a>(<a class="code" href="nyul__hist__normalization_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a>,max_value); %Histogram after removing background <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">   49</a></span>&#160;[Y,mu_s] = max(<a class="code" href="nyul__hist__normalization_8m.html#a88fd2e6e6c004e106a2981e2019af28e">template_hist</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;% Recover the structure <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="save__untouch__nii_8m.html#a5acb2d0a726641d28d07836ce7824f58">save</a> it</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">template</span>.img = reshape(<a class="code" href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>,<a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a>,b,<a class="code" href="reslice__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;% Save the <a class="code" href="hellier__hist__normalization__gmm_8m.html#af18417e627393682785b64624856b276">reference</a> after the scaling within <a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> <a class="code" href="nyul__hist__normalization_8m.html#a4b944c11163ea5f5da9a9364a27d4f96">range</a> (<a class="code" href="xform__nii_8m.html#a5389c938d8f439f89bc6549e6a18285d">e</a>.g. 1-256)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a9da1c5bb0415b12dbd914152502024c9">save_untouch_nii</a>(<a class="code" href="nyul__hist__normalization_8m.html#a4c5667bb1bab250339f9858b6e2e5268">template</a>,[ file_name_template(1:<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>-4) &#39;_scaled.<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>&#39;] );</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;% Preprocess the <a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a> histogram</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;%Load MASK Nifti-file</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#af199202624b28a063b1966a23bdc5753">mask_moving</a> = <a class="code" href="nyul__hist__normalization_8m.html#a025c4feb9db701a892ecb8f172e01ffb">load_untouch_nii</a>(file_mask_moving);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>  = <a class="code" href="nyul__hist__normalization_8m.html#a025c4feb9db701a892ecb8f172e01ffb">load_untouch_nii</a>(file_name_moving);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.<a class="code" href="nyul__hist__normalization_8m.html#aa9440f791ebae83f1318b83aed3cd178">img</a> = <span class="keywordtype">double</span>(<a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.<a class="code" href="nyul__hist__normalization_8m.html#aa9440f791ebae83f1318b83aed3cd178">img</a>) .* <span class="keywordtype">double</span>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#af199202624b28a063b1966a23bdc5753">mask_moving</a>.<a class="code" href="nyul__hist__normalization_8m.html#aa9440f791ebae83f1318b83aed3cd178">img</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;[<a class="code" href="reslice__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a> f g] = size(<a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.img);</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a72892a92f2b50e685c06c57a90c5dea4">   62</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a> = reshape(<a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.img,1,<a class="code" href="reslice__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>*f*g);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a> = max_value * (<a class="code" href="nyul__hist__normalization_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a> - min(<a class="code" href="nyul__hist__normalization_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>) )/( max(<a class="code" href="nyul__hist__normalization_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>) -min(<a class="code" href="nyul__hist__normalization_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>)); %<a class="code" href="namespaceanima.html#a75307a7eb3fa0266ae6134d2c65dba63">Normalize</a> between 0 <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> 256</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;%<a class="code" href="nyul__hist__normalization_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a>; <a class="code" href="nyul__hist__normalization_8m.html#ae7b9eccc00b2a0a6017140677e100eaf">hist</a>(converted_data_t,max_value); %Histogram without any processing</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;%Remove background <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a> = find( converted_data_t &gt; <a class="code" href="nyul__hist__normalization_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">max_background_value</a> &amp; converted_data_t &lt; <a class="code" href="nyul__hist__normalization_8m.html#a9614fa52c618a1b02bde3c390d7137b6">min_noise_value</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#aedf19848b0ad4720774fe7fff4e292a0">   67</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a> = converted_data_t(<a class="code" href="nyul__hist__normalization_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;%figure; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;%<a class="code" href="nyul__hist__normalization_8m.html#ae7b9eccc00b2a0a6017140677e100eaf">hist</a>(<a class="code" href="nyul__hist__normalization_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a>,max_value);</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#a57223a7913449a15b097dc5993cb91fd">   70</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a57223a7913449a15b097dc5993cb91fd">target_hist</a> = <a class="code" href="nyul__hist__normalization_8m.html#ae7b9eccc00b2a0a6017140677e100eaf">hist</a>(cleaned_converted_data_t,max_value); %Histogram after removing background <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;[Y,mu_i] = max( <a class="code" href="nyul__hist__normalization_8m.html#a57223a7913449a15b097dc5993cb91fd">target_hist</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;%Histogram standardization</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="nyul__hist__normalization_8m.html#ada4c9e2ca60838701b695baa18989ef5">   74</a></span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#ada4c9e2ca60838701b695baa18989ef5">standardized_hist</a> = zeros(size(cleaned_converted_data_t));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a7c8a2dea8e7d1d579df5ce81b92211b4">for</a> (jj= 1 : <a class="code" href="load__nii__img_8m.html#a706b80f8d6a58d25b3b0e0821fd2d2a1">length</a>(cleaned_converted_data_t))</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a>  (cleaned_converted_data_t(jj) &lt; mu_i)      </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="nyul__hist__normalization_8m.html#ada4c9e2ca60838701b695baa18989ef5">standardized_hist</a>(jj) = mu_s + ( cleaned_converted_data_t(jj) - mu_i ) * ( <a class="code" href="nyul__hist__normalization_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">s1</a> - mu_s ) / ( <a class="code" href="nyul__hist__normalization_8m.html#ab3d7170ac42bb69d2d4921867523a104">p1i</a> - mu_i ) ; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="nyul__hist__normalization_8m.html#ada4c9e2ca60838701b695baa18989ef5">standardized_hist</a>(jj) = mu_s + ( cleaned_converted_data_t(jj) - mu_i ) * ( <a class="code" href="nyul__hist__normalization_8m.html#a7cfc0f10b3c9243718d965fd3e229f54">s2</a> - mu_s ) / ( <a class="code" href="nyul__hist__normalization_8m.html#a0396bc795783c332d98bc9a65e2275dd">p2i</a> - mu_i ) ; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;%figure; <a class="code" href="nyul__hist__normalization_8m.html#ae7b9eccc00b2a0a6017140677e100eaf">hist</a>(<a class="code" href="nyul__hist__normalization_8m.html#ada4c9e2ca60838701b695baa18989ef5">standardized_hist</a>,max_value); %Histogram after standardization</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;% Update the data according to the scaling of the histogram</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;converted_data_t( cleaned_index ) = standardized_hist;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;% Recover the structure <a class="code" href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="save__untouch__nii_8m.html#a5acb2d0a726641d28d07836ce7824f58">save</a> it</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.img = reshape(converted_data_t,<a class="code" href="reslice__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>,f,g);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<a class="code" href="nyul__hist__normalization_8m.html#a9da1c5bb0415b12dbd914152502024c9">save_untouch_nii</a>(<a class="code" href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>,[   file_name_moving(1:<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>-4) &#39;_stretched.nii&#39;] );</div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ab66251c08e0241221a1f306f8c4760f5"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a></div><div class="ttdeci">Check the ordering of the means if(mu_i_first_subset&lt; mu_i_second_subset &amp;mu_i_first_subset&lt; mu_i_third_subset) disp('The first Gaussian is the CSF')</div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_ae7b9eccc00b2a0a6017140677e100eaf"><div class="ttname"><a href="nyul__hist__normalization_8m.html#ae7b9eccc00b2a0a6017140677e100eaf">hist</a></div><div class="ttdeci">hist(converted_data, max_value)</div></div>
<div class="ttc" id="xform__nii_8m_html_a9b871d477ed7a0a4dfe8ab1fc037091b"><div class="ttname"><a href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a></div><div class="ttdeci">Jeff end if scl_slope field is then each voxel value in the dataset should be scaled as</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00078">xform_nii.m:78</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a7cfc0f10b3c9243718d965fd3e229f54"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a7cfc0f10b3c9243718d965fd3e229f54">s2</a></div><div class="ttdeci">absolute min value s2</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00025">nyul_hist_normalization.m:25</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_aa82e6383b921cf10c8e48000127ff7dc"><div class="ttname"><a href="nyul__hist__normalization_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a></div><div class="ttdeci">figure</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00042">nyul_hist_normalization.m:42</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a5389c938d8f439f89bc6549e6a18285d"><div class="ttname"><a href="xform__nii_8m.html#a5389c938d8f439f89bc6549e6a18285d">e</a></div><div class="ttdeci">hdr.dime.xyzt_units, 7 e()</div></div>
<div class="ttc" id="load__nii__img_8m_html_a706b80f8d6a58d25b3b0e0821fd2d2a1"><div class="ttname"><a href="load__nii__img_8m.html#a706b80f8d6a58d25b3b0e0821fd2d2a1">length</a></div><div class="ttdeci">end if length(unique(img_idx))~</div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a9614fa52c618a1b02bde3c390d7137b6"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a9614fa52c618a1b02bde3c390d7137b6">min_noise_value</a></div><div class="ttdeci">Assume that the background values are or min_noise_value</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00020">nyul_hist_normalization.m:20</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_aa1e625dc7dab253ffa4aef21f1a68c07"><div class="ttname"><a href="nyul__hist__normalization_8m.html#aa1e625dc7dab253ffa4aef21f1a68c07">nyul_hist_normalization</a></div><div class="ttdeci">A Crimi Histogram standardization Nyul et al The general idea is to strech a target histogram according to the mode and shoulder of a template histogram MRI data is set the mode and shoulder to use as the WhiteMatter mode Histogram standardization of Volume function nyul_hist_normalization(file_name_template, file_name_moving, file_mask_template, file_mask_moving)%Parameter for removing background values and noise outlier%These are common sensible values max_value</div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a4b944c11163ea5f5da9a9364a27d4f96"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a4b944c11163ea5f5da9a9364a27d4f96">range</a></div><div class="ttdeci">Save the reference after the scaling within a range(e.g.1-256) save_untouch_nii(template</div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a025c4feb9db701a892ecb8f172e01ffb"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a025c4feb9db701a892ecb8f172e01ffb">load_untouch_nii</a></div><div class="ttdeci">file_mask_template load_untouch_nii()</div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_ab3d7170ac42bb69d2d4921867523a104"><div class="ttname"><a href="nyul__hist__normalization_8m.html#ab3d7170ac42bb69d2d4921867523a104">p1i</a></div><div class="ttdeci">left shoulder mode background template p1i</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00023">nyul_hist_normalization.m:23</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a88fd2e6e6c004e106a2981e2019af28e"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a88fd2e6e6c004e106a2981e2019af28e">template_hist</a></div><div class="ttdeci">template_hist</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00048">nyul_hist_normalization.m:48</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a5d2c023108742a1ce78ba9823c06ea35"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a></div><div class="ttdeci">right shoulder mode foreground target</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00030">nyul_hist_normalization.m:30</a></div></div>
<div class="ttc" id="save__untouch__nii_8m_html_a7bd3e5e3766c0b45fc244c495cf0fd1c"><div class="ttname"><a href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a></div><div class="ttdeci">end switch double(hdr.dime.datatype)</div></div>
<div class="ttc" id="reslice__nii_8m_html_a5f512d455013d953e6018dee349e78f6"><div class="ttname"><a href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div><div class="ttdeci">end else[img M]</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00109">reslice_nii.m:109</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a57223a7913449a15b097dc5993cb91fd"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a57223a7913449a15b097dc5993cb91fd">target_hist</a></div><div class="ttdeci">target_hist</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00070">nyul_hist_normalization.m:70</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a7c8a2dea8e7d1d579df5ce81b92211b4"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a7c8a2dea8e7d1d579df5ce81b92211b4">for</a></div><div class="ttdeci">for(jj=1:length(cleaned_converted_data_t)) if(cleaned_converted_data_t(jj)&lt; mu_i) standardized_hist(jj)</div></div>
<div class="ttc" id="reslice__nii_8m_html_a1aabac6d068eef6a7bad3fdf50a05cc8"><div class="ttname"><a href="reslice__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a></div><div class="ttdeci">d</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00217">reslice_nii.m:217</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a72892a92f2b50e685c06c57a90c5dea4"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a></div><div class="ttdeci">converted_data_t</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00062">nyul_hist_normalization.m:62</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_aa9440f791ebae83f1318b83aed3cd178"><div class="ttname"><a href="nyul__hist__normalization_8m.html#aa9440f791ebae83f1318b83aed3cd178">img</a></div><div class="ttdeci">template img</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00036">nyul_hist_normalization.m:36</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a2aab5d576d87bc08a721fe1cbeab0236"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a2aab5d576d87bc08a721fe1cbeab0236">multimodale</a></div><div class="ttdeci">A Crimi Histogram standardization Nyul et al The general idea is to strech a target histogram according to the mode and shoulder of a template histogram MRI data is multimodale</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00008">nyul_hist_normalization.m:8</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_ab9a48810d2822c2d15b7355abd232e4c"><div class="ttname"><a href="nyul__hist__normalization_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a></div><div class="ttdeci">Histogram without any processing Remove background and outliers cleaned_index</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00044">nyul_hist_normalization.m:44</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a342262936bbc8720d9d9afadfbf10e7a"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a342262936bbc8720d9d9afadfbf10e7a">converted_data_s</a></div><div class="ttdeci">Normalize between and converted_data_s</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00041">nyul_hist_normalization.m:41</a></div></div>
<div class="ttc" id="save__untouch__nii_8m_html_a5acb2d0a726641d28d07836ce7824f58"><div class="ttname"><a href="save__untouch__nii_8m.html#a5acb2d0a726641d28d07836ce7824f58">save</a></div><div class="ttdeci">save(fileprefix, 'M')</div></div>
<div class="ttc" id="reslice__nii_8m_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="reslice__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00216">reslice_nii.m:216</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_af18417e627393682785b64624856b276"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#af18417e627393682785b64624856b276">reference</a></div><div class="ttdeci">Histogram after removing background and noise Find the main Gaussians for the reference(WM, GM, CSF)[data_label model]</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_af199202624b28a063b1966a23bdc5753"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#af199202624b28a063b1966a23bdc5753">mask_moving</a></div><div class="ttdeci">Preprocess the target Skull mask mask_moving</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00065">hellier_hist_normalization_gmm.m:65</a></div></div>
<div class="ttc" id="namespaceanima_html_a75307a7eb3fa0266ae6134d2c65dba63"><div class="ttname"><a href="namespaceanima.html#a75307a7eb3fa0266ae6134d2c65dba63">anima::Normalize</a></div><div class="ttdeci">void Normalize(const VectorType &amp;v, const unsigned int NDimension, VectorType &amp;resVec)</div><div class="ttdef"><b>Definition:</b> <a href="animaVectorOperations_8hxx_source.html#l00333">animaVectorOperations.hxx:333</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a63733d4646d75ddb08066b7382841ee0"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a></div><div class="ttdeci">converted_data</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00039">nyul_hist_normalization.m:39</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ab532f211a59e750f5f2657bc5e2172ab"><div class="ttname"><a href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a></div><div class="ttdeci">after we figure out the angles and squash them to closest rectilinear direction After that</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00389">xform_nii.m:389</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a9164ee040b2d05f08dc562788b20ad0b"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a9164ee040b2d05f08dc562788b20ad0b">p2j</a></div><div class="ttdeci">absolute max value DATA DEPENDENT PARAMENTER Not extremely critical but they need to be the data are normalized between therefore these values should be always fine p2j</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00029">nyul_hist_normalization.m:29</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_aedf19848b0ad4720774fe7fff4e292a0"><div class="ttname"><a href="nyul__hist__normalization_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a></div><div class="ttdeci">cleaned_converted_data_t</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00067">nyul_hist_normalization.m:67</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a42e7bb345661535df7bd5e3137f988f2"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a></div><div class="ttdeci">cleaned_converted_data</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00045">nyul_hist_normalization.m:45</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a0396bc795783c332d98bc9a65e2275dd"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a0396bc795783c332d98bc9a65e2275dd">p2i</a></div><div class="ttdeci">right shoulder mode foreground it is some sort of measurement of the variance p2i</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00030">nyul_hist_normalization.m:30</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a0e59908ff00ce07861ead56d41e8e8b3"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a></div><div class="ttdeci">absolute max value DATA DEPENDENT PARAMENTER Not extremely critical but they need to be the data are normalized between and</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00025">nyul_hist_normalization.m:25</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a9da1c5bb0415b12dbd914152502024c9"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a9da1c5bb0415b12dbd914152502024c9">save_untouch_nii</a></div><div class="ttdeci">save_untouch_nii(target,[file_name_moving(1:end-4) '_stretched.nii'])</div></div>
<div class="ttc" id="load__untouch__nii_8m_html_ad687cafb469fa0ea5f34a64e7eb84ec5"><div class="ttname"><a href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a></div><div class="ttdeci">Perform some of sform qform transform nii</div><div class="ttdef"><b>Definition:</b> <a href="load__untouch__nii_8m_source.html#l00123">load_untouch_nii.m:123</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a7e8e71b97c47916e1918ef3c16261fd4"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">max_background_value</a></div><div class="ttdeci">max_background_value</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00019">nyul_hist_normalization.m:19</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a6c6a302e257e1a23d0671bc6ee3f94f9"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a6c6a302e257e1a23d0671bc6ee3f94f9">p1j</a></div><div class="ttdeci">Assume that the noise has values of and Histogram dependent parameters set by users Not critical p1j</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00022">nyul_hist_normalization.m:22</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a5c2f5cf403c7bb3b255cec9577b4e465"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a5c2f5cf403c7bb3b255cec9577b4e465">sensible</a></div><div class="ttdeci">absolute max value DATA DEPENDENT PARAMENTER Not extremely critical but they need to be sensible</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00025">nyul_hist_normalization.m:25</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_af2d63b31e3340ec6ad1fd8426e16a875"><div class="ttname"><a href="nyul__hist__normalization_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">s1</a></div><div class="ttdeci">left shoulder mode background target s1</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00024">nyul_hist_normalization.m:24</a></div></div>
<div class="ttc" id="reslice__nii_8m_html_a1ede835792071dff91c0e008e7c3b16a"><div class="ttname"><a href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a></div><div class="ttdeci">end else a</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00226">reslice_nii.m:226</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a4c5667bb1bab250339f9858b6e2e5268"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a4c5667bb1bab250339f9858b6e2e5268">template</a></div><div class="ttdeci">right shoulder mode foreground template</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00029">nyul_hist_normalization.m:29</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_ada4c9e2ca60838701b695baa18989ef5"><div class="ttname"><a href="nyul__hist__normalization_8m.html#ada4c9e2ca60838701b695baa18989ef5">standardized_hist</a></div><div class="ttdeci">Histogram standardization standardized_hist</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00074">nyul_hist_normalization.m:74</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a8578578ec77a3f9de34d6d0a700f70c3"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a></div><div class="ttdeci">Histogram after removing background and noise[Y, mu_s]</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00049">nyul_hist_normalization.m:49</a></div></div>
<div class="ttc" id="load__nii__img_8m_html_a0e58fe5bf1f468ebd8ae6b3620a52472"><div class="ttname"><a href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div><div class="ttdeci">end end[img, hdr]</div><div class="ttdef"><b>Definition:</b> <a href="load__nii__img_8m_source.html#l00115">load_nii_img.m:115</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 11 2014 15:55:49 for ANIMA by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
