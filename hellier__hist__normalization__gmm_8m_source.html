<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ANIMA: hellier_hist_normalization_gmm.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ANIMA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5ce0a585544ccf90f6c4541b827e0dfc.html">anima-nightly-src</a></li><li class="navelem"><a class="el" href="dir_0fad36fe10bbcca9e7c6f0593f8115a7.html">filtering</a></li><li class="navelem"><a class="el" href="dir_a8c965e58a3e16f0722aea8ebc1f2ff0.html">nyul_standardization</a></li><li class="navelem"><a class="el" href="dir_369872ed032a3cd8f5543300e1c0f96c.html">matlab_intensity_standardization</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">hellier_hist_normalization_gmm.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="hellier__hist__normalization__gmm_8m.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;%</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;% A.Crimi 18.01.2012</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;% Histogram standardization Nyul et al. 2000</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;% GMM version of Pierre Hellier</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;% The general idea is to strech <a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> <a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a> histogram according to the mode <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;% shoulder of <a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> <span class="keyword">template</span> histogram.</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;%</div>
<div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a81e12916b4d3e68242f0ac25c3ff1035">    9</a></span>&#160;% MRI data is <a class="code" href="hellier__hist__normalization__gmm_8m.html#af2d0867544fd8caf55ecc47208093ebd">multimodale</a>, set the mode of the  shoulder to use <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> the</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;% WhiteMatter mode.</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;%</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;% <a class="code" href="hellier__hist__normalization__gmm_8m.html#a81e12916b4d3e68242f0ac25c3ff1035">NOTE</a> : The method produces <a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> mixture of Gaussians similar to the <span class="keyword">template</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;% however it introduces <a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> lot of <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a> <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> errors. </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;% A more reliable implementation requieres <a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> better prior based on the neighbourhood,</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;% see Greenspan et al. 2006 <span class="keywordflow">for</span> example.</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;%</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;% Histogram standardization of Volume</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">function</span> <a class="code" href="hellier__hist__normalization__gmm_8m.html#a16d676f46337246168a90d7f684ba4b0">hellier_hist_normalization_gmm</a>( file_name_template, file_name_moving, file_mask_template, file_mask_moving )</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;% Parameter <span class="keywordflow">for</span> removing background values <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a> outlier</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;%These are common <a class="code" href="hellier__hist__normalization__gmm_8m.html#a5c2f5cf403c7bb3b255cec9577b4e465">sensible</a> values</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;max_value =  256;</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">   25</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">max_background_value</a> = 1; %Assume <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> the background values are 0 or 1</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a9614fa52c618a1b02bde3c390d7137b6">   26</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a9614fa52c618a1b02bde3c390d7137b6">min_noise_value</a> =  254; %Assume <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> lesions <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a> have values of 254 <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> 255</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;%Histogram dependent  parameters set by users. Not critical</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ab3b5813b5f0dbbe620145e0407e3da4e">   28</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab3b5813b5f0dbbe620145e0407e3da4e">p1j</a> = 0; % left shoulder mode background <span class="keyword">template</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ab3d7170ac42bb69d2d4921867523a104">   29</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab3d7170ac42bb69d2d4921867523a104">p1i</a> = 0; % left shoulder mode background <a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a></div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">   30</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">s1</a> = 1; % absolute min value </div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a5c2f5cf403c7bb3b255cec9577b4e465">   31</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a7cfc0f10b3c9243718d965fd3e229f54">s2</a> = max_value;%255; % absolute max value</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;% DATA DEPENDENT PARAMENTER!!!!</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;% Not extremely critical but they need to be <a class="code" href="hellier__hist__normalization__gmm_8m.html#a5c2f5cf403c7bb3b255cec9577b4e465">sensible</a>, the data are</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;% normalized between 0 <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> 255,therefore these values should be always fine</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a9164ee040b2d05f08dc562788b20ad0b">   35</a></span>&#160;%<a class="code" href="hellier__hist__normalization__gmm_8m.html#a9164ee040b2d05f08dc562788b20ad0b">p2j</a> = 210; %right shoulder mode foreground <span class="keyword">template</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;%Load MASK Nifti-file</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;%Skull mask</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;mask_template = <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a>(file_mask_template); </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;%Preprocess the <span class="keyword">template</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#aae3b27fd54f9de0ed470493cb1b19bb5">   41</a></span>&#160;<span class="keyword">template</span>  = <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a>(file_name_template);</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#adc359efc23ea39d0411c481c3123f64b">   42</a></span>&#160;<span class="keyword">template</span>.img = <a class="code" href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a>(<span class="keyword">template</span>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a>) .*  <a class="code" href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a>(mask_template.img); % Remove <a class="code" href="hellier__hist__normalization__gmm_8m.html#ae752e28a4734d19970d29a9db7738db9">skull</a></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ae752e28a4734d19970d29a9db7738db9">   43</a></span>&#160;[a b c] = size(<span class="keyword">template</span>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">   44</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> = reshape(<span class="keyword">template</span>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a>,1,<a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a>*b*<a class="code" href="reslice__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>);      </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> = max_value * (<a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> - min(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>) )/( max(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>) -min(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>)); %<a class="code" href="namespaceanima.html#a75307a7eb3fa0266ae6134d2c65dba63">Normalize</a> <a class="code" href="load__nii__img_8m.html#a696955a77261efd5167a5ffef15ce32d">range</a></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;%Save the scaled version of the <a class="code" href="hellier__hist__normalization__gmm_8m.html#af18417e627393682785b64624856b276">reference</a> volume</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">template</span>.img = reshape(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>,<a class="code" href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a>,b,<a class="code" href="reslice__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#abb34ee6a8cd6364b503b12de9ea37495">save_untouch_nii</a>(<span class="keyword">template</span>,[ file_name_template(1:<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>-4) <span class="stringliteral">&#39;_scaled.nii&#39;</span>] );</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;%Remove background <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> artefacts from <span class="keyword">template</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ab9a48810d2822c2d15b7355abd232e4c">   50</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a> = find( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a> &gt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">max_background_value</a>  );</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a42e7bb345661535df7bd5e3137f988f2">   51</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a>);</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#aa82e6383b921cf10c8e48000127ff7dc">   52</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a>; <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a>,max_value); %Histogram after removing background <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;%Find the 3 <a class="code" href="animaDDIModelAveraging_8cxx.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> Gaussians <span class="keywordflow">for</span> the <a class="code" href="hellier__hist__normalization__gmm_8m.html#af18417e627393682785b64624856b276">reference</a> (WM,GM,CSF)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;[data_label model ]  = emgm( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a>, 3, 0);</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">   55</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a> = round(median(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a>(find(data_label==1))));</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">   56</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> = round(median(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a>(find(data_label==2))));</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">   57</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> = round(median(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a>(find(data_label==3))));</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ae1faaa3fedc82a59c523a5f60b2e900f">   58</a></span>&#160;% Check the order of the <a class="code" href="hellier__hist__normalization__gmm_8m.html#ae1faaa3fedc82a59c523a5f60b2e900f">means</a>, <span class="keyword">this</span> is the order <span class="keywordflow">for</span> T1</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a3fc2cfeb4a8d609d0486f01820dd90d0">   59</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a3fc2cfeb4a8d609d0486f01820dd90d0">mu_csf</a> = min([ <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> ]);</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ae9f394959de67477d0f86aefde283a8b">   60</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ae9f394959de67477d0f86aefde283a8b">mu_wm</a> = max([ <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> ]);</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a9c6bd074154aba08ff4d5b074138ac47">   61</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a9c6bd074154aba08ff4d5b074138ac47">mu_gm</a> = median([ <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> ]);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;% Preprocess the <a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a> </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;%Skull mask</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#af199202624b28a063b1966a23bdc5753">   65</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#af199202624b28a063b1966a23bdc5753">mask_moving</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a>(file_mask_moving); </div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">   66</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>  = <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a>(file_name_moving);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.img = <a class="code" href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.img) .* <a class="code" href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#af199202624b28a063b1966a23bdc5753">mask_moving</a>.img); % Remove <a class="code" href="hellier__hist__normalization__gmm_8m.html#ae752e28a4734d19970d29a9db7738db9">skull</a></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;[d f g] = size(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.img);</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">   69</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a> = <a class="code" href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a>(reshape(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.img,1,<a class="code" href="reslice__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>*f*g));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a> = max_value * (<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a> - min(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>) )/( max(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>) -min(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>)); %<a class="code" href="namespaceanima.html#a75307a7eb3fa0266ae6134d2c65dba63">Normalize</a> between 0 <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> 256</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;%Remove background <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a> from <a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a> = find( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a> &gt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">max_background_value</a> &amp; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a> &lt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a9614fa52c618a1b02bde3c390d7137b6">min_noise_value</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#aedf19848b0ad4720774fe7fff4e292a0">   73</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>(cleaned_index);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a>; <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a>,max_value); %Histogram after removing background <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;%Find the 3 <a class="code" href="animaDDIModelAveraging_8cxx.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> Gaussians <span class="keywordflow">for</span> the <a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a> (WM,GM,CSF)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;[data_label model] = emgm( <a class="code" href="hellier__hist__normalization__gmm_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a>, 3, 0) ;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a50c83dc60dc0b1041302247b443796ad">   77</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a50c83dc60dc0b1041302247b443796ad">first_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a>(find(data_label==1)); </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ad9b761e66621692a5b7f5a17f01e8b80">   78</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ad9b761e66621692a5b7f5a17f01e8b80">std_first</a> = std(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a50c83dc60dc0b1041302247b443796ad">first_subset</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">   79</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a> = round(median(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a50c83dc60dc0b1041302247b443796ad">first_subset</a>));</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a5f950d4ea839f6e74a67d1915d55e9c9">   80</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5f950d4ea839f6e74a67d1915d55e9c9">second_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a>(find(data_label==2));</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a594d35be9e977f4b4be27de22f4901fc">   81</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a594d35be9e977f4b4be27de22f4901fc">std_second</a> = std(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5f950d4ea839f6e74a67d1915d55e9c9">second_subset</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">   82</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a> = round(median(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5f950d4ea839f6e74a67d1915d55e9c9">second_subset</a> ));</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a09cb3a584b89a3337b08d7c8706825dd">   83</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a09cb3a584b89a3337b08d7c8706825dd">third_subset</a> =  <a class="code" href="hellier__hist__normalization__gmm_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a>(find(data_label==3));</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a5519daf11da1a7972cab5a84dacf9309">   84</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5519daf11da1a7972cab5a84dacf9309">std_third</a> = std(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a09cb3a584b89a3337b08d7c8706825dd">third_subset</a>);</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">   85</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a> = round(median(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a09cb3a584b89a3337b08d7c8706825dd">third_subset</a>));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;%Check the ordering of the means</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keywordflow">if</span>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a> &lt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a> &amp; <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a> &lt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a>)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(<span class="stringliteral">&#39;The first Gaussian is the CSF&#39;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a3fc2cfeb4a8d609d0486f01820dd90d0">mu_csf</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a> &lt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a>)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(<span class="stringliteral">&#39;The last Gaussian is the WM&#39;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a9c6bd074154aba08ff4d5b074138ac47">mu_gm</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#ae9f394959de67477d0f86aefde283a8b">mu_wm</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(<span class="stringliteral">&#39;The last Gaussian is the GM&#39;</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#ae9f394959de67477d0f86aefde283a8b">mu_wm</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a9c6bd074154aba08ff4d5b074138ac47">mu_gm</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a61c2a47b64784151e1719e8205833341">elseif</a> (<a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a> &gt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a> &amp; <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a> &gt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a>)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(&#39;The first Gaussian is the WM&#39;); </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a3fc2cfeb4a8d609d0486f01820dd90d0">mu_csf</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a> &gt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a>)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(&#39;The last Gaussian is the GM&#39;);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a9c6bd074154aba08ff4d5b074138ac47">mu_gm</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#ae9f394959de67477d0f86aefde283a8b">mu_wm</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(&#39;The last Gaussian is the CSF&#39;);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> = mu_wm;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> = mu_gm;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(&#39;The middle Gaussian is the CSF&#39;);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a>  = mu_csf;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a> &lt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a>)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(&#39;The last Gaussian is the WM&#39;);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a> = mu_gm;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> = mu_wm;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a>(&#39;The last Gaussian is the GM&#39;);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a> = mu_wm;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> = mu_gm;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;%Histogram standardization</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#ad129f3ab7edf080aea99c5bafe885fdb">  134</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#ad129f3ab7edf080aea99c5bafe885fdb">standardized_hist</a> = zeros(size(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a50c83dc60dc0b1041302247b443796ad">first_subset</a>));</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="hellier__hist__normalization__gmm_8m.html#a0fd801d843b0e59e880d9a0d3be592ca">  135</a></span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a0fd801d843b0e59e880d9a0d3be592ca">p2i</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a> + <a class="code" href="hellier__hist__normalization__gmm_8m.html#ad9b761e66621692a5b7f5a17f01e8b80">std_first</a> ;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> (jj= 1 : <a class="code" href="load__nii__img_8m.html#a706b80f8d6a58d25b3b0e0821fd2d2a1">length</a>(first_subset))</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a>  (first_subset(jj) &lt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a>)      </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <a class="code" href="hellier__hist__normalization__gmm_8m.html#ad129f3ab7edf080aea99c5bafe885fdb">standardized_hist</a>(jj) = <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a> + ( first_subset(jj) - <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a> )   * ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">s1</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a> ) / ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab3d7170ac42bb69d2d4921867523a104">p1i</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a>) ; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="hellier__hist__normalization__gmm_8m.html#ad129f3ab7edf080aea99c5bafe885fdb">standardized_hist</a>(jj) = <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a> + ( first_subset(jj) - mu_i_first_subset )  * ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a7cfc0f10b3c9243718d965fd3e229f54">s2</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a> ) / ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0fd801d843b0e59e880d9a0d3be592ca">p2i</a> - mu_i_first_subset ) ; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;% Update the data according to the scaling of the histogram</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>( cleaned_index(find(data_label==1)) ) = <a class="code" href="hellier__hist__normalization__gmm_8m.html#ad129f3ab7edf080aea99c5bafe885fdb">standardized_hist</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;standardized_hist = zeros(size(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5f950d4ea839f6e74a67d1915d55e9c9">second_subset</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a0fd801d843b0e59e880d9a0d3be592ca">p2i</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a> + <a class="code" href="hellier__hist__normalization__gmm_8m.html#a594d35be9e977f4b4be27de22f4901fc">std_second</a> ;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> (jj= 1 : <a class="code" href="load__nii__img_8m.html#a706b80f8d6a58d25b3b0e0821fd2d2a1">length</a>(second_subset))</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a>  (second_subset(jj) &lt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a>)      </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        standardized_hist(jj) = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> + ( second_subset(jj) - <a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a> )  * ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">s1</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> ) / ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab3d7170ac42bb69d2d4921867523a104">p1i</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a> ) ; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        standardized_hist(jj) = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> + ( second_subset(jj) - mu_i_second_subset )  * ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a7cfc0f10b3c9243718d965fd3e229f54">s2</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a> ) / ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0fd801d843b0e59e880d9a0d3be592ca">p2i</a> - mu_i_second_subset ) ; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;% Update the data according to the scaling of the histogram</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>( cleaned_index(find(data_label==2)) ) = standardized_hist;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;standardized_hist = zeros(size(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a09cb3a584b89a3337b08d7c8706825dd">third_subset</a>));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a0fd801d843b0e59e880d9a0d3be592ca">p2i</a> = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a>  + <a class="code" href="hellier__hist__normalization__gmm_8m.html#a5519daf11da1a7972cab5a84dacf9309">std_third</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> (jj= 1 : <a class="code" href="load__nii__img_8m.html#a706b80f8d6a58d25b3b0e0821fd2d2a1">length</a>(third_subset))</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a>  (third_subset(jj) &lt; <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a>)      </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        standardized_hist(jj) = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> + ( third_subset(jj) - <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a> )  * ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">s1</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> ) / ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab3d7170ac42bb69d2d4921867523a104">p1i</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a> ) ; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        standardized_hist(jj) = <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> + ( third_subset(jj) - mu_i_third_subset )  * ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a7cfc0f10b3c9243718d965fd3e229f54">s2</a> - <a class="code" href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a> ) / ( <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0fd801d843b0e59e880d9a0d3be592ca">p2i</a> - mu_i_third_subset ) ; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;% Update the data according to the scaling of the histogram</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>( cleaned_index(find(data_label==3)) ) = standardized_hist;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a>; <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a>(:),max_value); %Histogram after standardization</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;% Recover the structure <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="save__untouch__nii_8m.html#a5acb2d0a726641d28d07836ce7824f58">save</a> it</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a> = reshape(converted_data_t,<a class="code" href="reslice__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>,f,g);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<a class="code" href="hellier__hist__normalization__gmm_8m.html#abb34ee6a8cd6364b503b12de9ea37495">save_untouch_nii</a>(<a class="code" href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a>,[ file_name_moving(1:<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>-4) &#39;_stretched.<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>&#39;] );</div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ab66251c08e0241221a1f306f8c4760f5"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a></div><div class="ttdeci">Check the ordering of the means if(mu_i_first_subset&lt; mu_i_second_subset &amp;mu_i_first_subset&lt; mu_i_third_subset) disp('The first Gaussian is the CSF')</div></div>
<div class="ttc" id="animaDDIModelAveraging_8cxx_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="animaDDIModelAveraging_8cxx.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="animaDDIModelAveraging_8cxx_source.html#l00017">animaDDIModelAveraging.cxx:17</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a5c2f5cf403c7bb3b255cec9577b4e465"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a5c2f5cf403c7bb3b255cec9577b4e465">sensible</a></div><div class="ttdeci">absolute max value DATA DEPENDENT PARAMENTER Not extremely critical but they need to be sensible</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00031">hellier_hist_normalization_gmm.m:31</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a9b871d477ed7a0a4dfe8ab1fc037091b"><div class="ttname"><a href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a></div><div class="ttdeci">Jeff end if scl_slope field is then each voxel value in the dataset should be scaled as</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00078">xform_nii.m:78</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a9c6bd074154aba08ff4d5b074138ac47"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a9c6bd074154aba08ff4d5b074138ac47">mu_gm</a></div><div class="ttdeci">mu_gm</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00061">hellier_hist_normalization_gmm.m:61</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ad129f3ab7edf080aea99c5bafe885fdb"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ad129f3ab7edf080aea99c5bafe885fdb">standardized_hist</a></div><div class="ttdeci">end end mu_first_subset mu_second_subset mu_third_subset mu_i_first_subset mu_i_second_subset mu_i_third_subset Histogram standardization standardized_hist</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00134">hellier_hist_normalization_gmm.m:134</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a7e8e71b97c47916e1918ef3c16261fd4"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a7e8e71b97c47916e1918ef3c16261fd4">max_background_value</a></div><div class="ttdeci">max_background_value</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00025">hellier_hist_normalization_gmm.m:25</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_af2d0867544fd8caf55ecc47208093ebd"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#af2d0867544fd8caf55ecc47208093ebd">multimodale</a></div><div class="ttdeci">A Crimi Histogram standardization Nyul et al GMM version of Pierre Hellier The general idea is to strech a target histogram according to the mode and shoulder of a template histogram MRI data is multimodale</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00009">hellier_hist_normalization_gmm.m:9</a></div></div>
<div class="ttc" id="load__nii__img_8m_html_a706b80f8d6a58d25b3b0e0821fd2d2a1"><div class="ttname"><a href="load__nii__img_8m.html#a706b80f8d6a58d25b3b0e0821fd2d2a1">length</a></div><div class="ttdeci">end if length(unique(img_idx))~</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_aa82e6383b921cf10c8e48000127ff7dc"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a></div><div class="ttdeci">figure</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00052">hellier_hist_normalization_gmm.m:52</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ab3b5813b5f0dbbe620145e0407e3da4e"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ab3b5813b5f0dbbe620145e0407e3da4e">p1j</a></div><div class="ttdeci">Assume that lesions and noise have values of and Histogram dependent parameters set by users Not critical p1j</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00028">hellier_hist_normalization_gmm.m:28</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_aedf19848b0ad4720774fe7fff4e292a0"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#aedf19848b0ad4720774fe7fff4e292a0">cleaned_converted_data_t</a></div><div class="ttdeci">cleaned_converted_data_t</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00073">hellier_hist_normalization_gmm.m:73</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ab3d7170ac42bb69d2d4921867523a104"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ab3d7170ac42bb69d2d4921867523a104">p1i</a></div><div class="ttdeci">left shoulder mode background template p1i</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00029">hellier_hist_normalization_gmm.m:29</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a7cfc0f10b3c9243718d965fd3e229f54"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a7cfc0f10b3c9243718d965fd3e229f54">s2</a></div><div class="ttdeci">absolute min value s2</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00031">hellier_hist_normalization_gmm.m:31</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a5519daf11da1a7972cab5a84dacf9309"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a5519daf11da1a7972cab5a84dacf9309">std_third</a></div><div class="ttdeci">std_third</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00084">hellier_hist_normalization_gmm.m:84</a></div></div>
<div class="ttc" id="save__untouch__nii_8m_html_a7bd3e5e3766c0b45fc244c495cf0fd1c"><div class="ttname"><a href="save__untouch__nii_8m.html#a7bd3e5e3766c0b45fc244c495cf0fd1c">double</a></div><div class="ttdeci">end switch double(hdr.dime.datatype)</div></div>
<div class="ttc" id="reslice__nii_8m_html_a5f512d455013d953e6018dee349e78f6"><div class="ttname"><a href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div><div class="ttdeci">end else[img M]</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00109">reslice_nii.m:109</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a61c2a47b64784151e1719e8205833341"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a61c2a47b64784151e1719e8205833341">elseif</a></div><div class="ttdeci">end elseif(mu_i_first_subset &gt; mu_i_second_subset &amp;mu_i_first_subset &gt; mu_i_third_subset) disp('The first Gaussian is the WM')</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ab731fd3d331f10ec6151c2897aed450a"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a></div><div class="ttdeci">hist(cleaned_converted_data, max_value)</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a72892a92f2b50e685c06c57a90c5dea4"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a72892a92f2b50e685c06c57a90c5dea4">converted_data_t</a></div><div class="ttdeci">converted_data_t</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00069">hellier_hist_normalization_gmm.m:69</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a513e661e51630125cae9fcb0a9328184"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a513e661e51630125cae9fcb0a9328184">mu_second_subset</a></div><div class="ttdeci">mu_second_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00056">hellier_hist_normalization_gmm.m:56</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a161bd5e3a7620ed68098717f269c00bc"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a161bd5e3a7620ed68098717f269c00bc">mu_i_third_subset</a></div><div class="ttdeci">mu_i_third_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00085">hellier_hist_normalization_gmm.m:85</a></div></div>
<div class="ttc" id="reslice__nii_8m_html_a1aabac6d068eef6a7bad3fdf50a05cc8"><div class="ttname"><a href="reslice__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a></div><div class="ttdeci">d</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00217">reslice_nii.m:217</a></div></div>
<div class="ttc" id="load__nii__img_8m_html_a696955a77261efd5167a5ffef15ce32d"><div class="ttname"><a href="load__nii__img_8m.html#a696955a77261efd5167a5ffef15ce32d">range</a></div><div class="ttdeci">else range</div><div class="ttdef"><b>Definition:</b> <a href="load__nii__img_8m_source.html#l00047">load_nii_img.m:47</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a16d676f46337246168a90d7f684ba4b0"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a16d676f46337246168a90d7f684ba4b0">hellier_hist_normalization_gmm</a></div><div class="ttdeci">A Crimi Histogram standardization Nyul et al GMM version of Pierre Hellier The general idea is to strech a target histogram according to the mode and shoulder of a template histogram MRI data is set the mode of the shoulder to use as the WhiteMatter mode see Greenspan et al for example Histogram standardization of Volume function hellier_hist_normalization_gmm(file_name_template, file_name_moving, file_mask_template, file_mask_moving)%Parameter for removing background values and noise outlier%These are common sensible values max_value</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ac0d3b30c098f641dbb0582537cb38777"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ac0d3b30c098f641dbb0582537cb38777">mu_first_subset</a></div><div class="ttdeci">mu_first_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00055">hellier_hist_normalization_gmm.m:55</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a3fc2cfeb4a8d609d0486f01820dd90d0"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a3fc2cfeb4a8d609d0486f01820dd90d0">mu_csf</a></div><div class="ttdeci">Check the order of the this is the order for T1 mu_csf</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00059">hellier_hist_normalization_gmm.m:59</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a800db9cee227dad51b57371a88e3925a"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a800db9cee227dad51b57371a88e3925a">mu_third_subset</a></div><div class="ttdeci">mu_third_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00057">hellier_hist_normalization_gmm.m:57</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a09cb3a584b89a3337b08d7c8706825dd"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a09cb3a584b89a3337b08d7c8706825dd">third_subset</a></div><div class="ttdeci">third_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00083">hellier_hist_normalization_gmm.m:83</a></div></div>
<div class="ttc" id="save__untouch__nii_8m_html_a5acb2d0a726641d28d07836ce7824f58"><div class="ttname"><a href="save__untouch__nii_8m.html#a5acb2d0a726641d28d07836ce7824f58">save</a></div><div class="ttdeci">save(fileprefix, 'M')</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a42e7bb345661535df7bd5e3137f988f2"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a42e7bb345661535df7bd5e3137f988f2">cleaned_converted_data</a></div><div class="ttdeci">cleaned_converted_data</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00051">hellier_hist_normalization_gmm.m:51</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ab9a48810d2822c2d15b7355abd232e4c"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ab9a48810d2822c2d15b7355abd232e4c">cleaned_index</a></div><div class="ttdeci">Remove background and artefacts from template cleaned_index</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00050">hellier_hist_normalization_gmm.m:50</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_abb34ee6a8cd6364b503b12de9ea37495"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#abb34ee6a8cd6364b503b12de9ea37495">save_untouch_nii</a></div><div class="ttdeci">save_untouch_nii(template,[file_name_template(1:end-4) '_scaled.nii'])</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ae752e28a4734d19970d29a9db7738db9"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ae752e28a4734d19970d29a9db7738db9">skull</a></div><div class="ttdeci">Remove skull[a b c]</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00043">hellier_hist_normalization_gmm.m:43</a></div></div>
<div class="ttc" id="reslice__nii_8m_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="reslice__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00216">reslice_nii.m:216</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_af18417e627393682785b64624856b276"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#af18417e627393682785b64624856b276">reference</a></div><div class="ttdeci">Histogram after removing background and noise Find the main Gaussians for the reference(WM, GM, CSF)[data_label model]</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_af199202624b28a063b1966a23bdc5753"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#af199202624b28a063b1966a23bdc5753">mask_moving</a></div><div class="ttdeci">Preprocess the target Skull mask mask_moving</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00065">hellier_hist_normalization_gmm.m:65</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a0e59908ff00ce07861ead56d41e8e8b3"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a></div><div class="ttdeci">absolute max value DATA DEPENDENT PARAMENTER Not extremely critical but they need to be the data are normalized between and</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00031">hellier_hist_normalization_gmm.m:31</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a81e12916b4d3e68242f0ac25c3ff1035"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a81e12916b4d3e68242f0ac25c3ff1035">NOTE</a></div><div class="ttdeci">A Crimi Histogram standardization Nyul et al GMM version of Pierre Hellier The general idea is to strech a target histogram according to the mode and shoulder of a template histogram MRI data is set the mode of the shoulder to use as the WhiteMatter mode NOTE</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00009">hellier_hist_normalization_gmm.m:9</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ad9b761e66621692a5b7f5a17f01e8b80"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ad9b761e66621692a5b7f5a17f01e8b80">std_first</a></div><div class="ttdeci">std_first</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00078">hellier_hist_normalization_gmm.m:78</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_aee8436234fdf2203232db313ab95d74b"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#aee8436234fdf2203232db313ab95d74b">mu_i_first_subset</a></div><div class="ttdeci">mu_i_first_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00079">hellier_hist_normalization_gmm.m:79</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a9164ee040b2d05f08dc562788b20ad0b"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a9164ee040b2d05f08dc562788b20ad0b">p2j</a></div><div class="ttdeci">absolute max value DATA DEPENDENT PARAMENTER Not extremely critical but they need to be the data are normalized between therefore these values should be always fine p2j</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00035">hellier_hist_normalization_gmm.m:35</a></div></div>
<div class="ttc" id="namespaceanima_html_a75307a7eb3fa0266ae6134d2c65dba63"><div class="ttname"><a href="namespaceanima.html#a75307a7eb3fa0266ae6134d2c65dba63">anima::Normalize</a></div><div class="ttdeci">void Normalize(const VectorType &amp;v, const unsigned int NDimension, VectorType &amp;resVec)</div><div class="ttdef"><b>Definition:</b> <a href="animaVectorOperations_8hxx_source.html#l00333">animaVectorOperations.hxx:333</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ae1faaa3fedc82a59c523a5f60b2e900f"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ae1faaa3fedc82a59c523a5f60b2e900f">means</a></div><div class="ttdeci">Check the order of the means</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00058">hellier_hist_normalization_gmm.m:58</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ab532f211a59e750f5f2657bc5e2172ab"><div class="ttname"><a href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a></div><div class="ttdeci">after we figure out the angles and squash them to closest rectilinear direction After that</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00389">xform_nii.m:389</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a9614fa52c618a1b02bde3c390d7137b6"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a9614fa52c618a1b02bde3c390d7137b6">min_noise_value</a></div><div class="ttdeci">Assume that the background values are or min_noise_value</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00026">hellier_hist_normalization_gmm.m:26</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a937015b0735346d40cdc2d827e5a1ba2"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a937015b0735346d40cdc2d827e5a1ba2">disp</a></div><div class="ttdeci">else disp('The last Gaussian is the GM')</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a0fd801d843b0e59e880d9a0d3be592ca"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a0fd801d843b0e59e880d9a0d3be592ca">p2i</a></div><div class="ttdeci">p2i</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00135">hellier_hist_normalization_gmm.m:135</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a63733d4646d75ddb08066b7382841ee0"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a63733d4646d75ddb08066b7382841ee0">converted_data</a></div><div class="ttdeci">converted_data</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00044">hellier_hist_normalization_gmm.m:44</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a5f950d4ea839f6e74a67d1915d55e9c9"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a5f950d4ea839f6e74a67d1915d55e9c9">second_subset</a></div><div class="ttdeci">second_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00080">hellier_hist_normalization_gmm.m:80</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a5d2c023108742a1ce78ba9823c06ea35"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a5d2c023108742a1ce78ba9823c06ea35">target</a></div><div class="ttdeci">target</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00066">hellier_hist_normalization_gmm.m:66</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ae9f394959de67477d0f86aefde283a8b"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ae9f394959de67477d0f86aefde283a8b">mu_wm</a></div><div class="ttdeci">mu_wm</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00060">hellier_hist_normalization_gmm.m:60</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a4797586c9f191ec7ffd84e764c4c54e7"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a></div><div class="ttdeci">for(jj=1:length(first_subset)) if(first_subset(jj)&lt; mu_i_first_subset) standardized_hist(jj)</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_adc359efc23ea39d0411c481c3123f64b"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a></div><div class="ttdeci">template img</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00042">hellier_hist_normalization_gmm.m:42</a></div></div>
<div class="ttc" id="load__untouch__nii_8m_html_ad687cafb469fa0ea5f34a64e7eb84ec5"><div class="ttname"><a href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a></div><div class="ttdeci">Perform some of sform qform transform nii</div><div class="ttdef"><b>Definition:</b> <a href="load__untouch__nii_8m_source.html#l00123">load_untouch_nii.m:123</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a50c83dc60dc0b1041302247b443796ad"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a50c83dc60dc0b1041302247b443796ad">first_subset</a></div><div class="ttdeci">first_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00077">hellier_hist_normalization_gmm.m:77</a></div></div>
<div class="ttc" id="reslice__nii_8m_html_a1ede835792071dff91c0e008e7c3b16a"><div class="ttname"><a href="reslice__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a></div><div class="ttdeci">end else a</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00226">reslice_nii.m:226</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a594d35be9e977f4b4be27de22f4901fc"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a594d35be9e977f4b4be27de22f4901fc">std_second</a></div><div class="ttdeci">std_second</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00081">hellier_hist_normalization_gmm.m:81</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_af2d63b31e3340ec6ad1fd8426e16a875"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#af2d63b31e3340ec6ad1fd8426e16a875">s1</a></div><div class="ttdeci">left shoulder mode background target s1</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00030">hellier_hist_normalization_gmm.m:30</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_aee68761b6ed79a43586f5dc87638d130"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a></div><div class="ttdeci">file_mask_template load_untouch_nii()</div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a726967107274b568a4a9f0be6c92ac4d"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a726967107274b568a4a9f0be6c92ac4d">mu_i_second_subset</a></div><div class="ttdeci">mu_i_second_subset</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00082">hellier_hist_normalization_gmm.m:82</a></div></div>
<div class="ttc" id="nyul__hist__normalization_8m_html_a8578578ec77a3f9de34d6d0a700f70c3"><div class="ttname"><a href="nyul__hist__normalization_8m.html#a8578578ec77a3f9de34d6d0a700f70c3">noise</a></div><div class="ttdeci">Histogram after removing background and noise[Y, mu_s]</div><div class="ttdef"><b>Definition:</b> <a href="nyul__hist__normalization_8m_source.html#l00049">nyul_hist_normalization.m:49</a></div></div>
<div class="ttc" id="load__nii__img_8m_html_a0e58fe5bf1f468ebd8ae6b3620a52472"><div class="ttname"><a href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div><div class="ttdeci">end end[img, hdr]</div><div class="ttdef"><b>Definition:</b> <a href="load__nii__img_8m_source.html#l00115">load_nii_img.m:115</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 11 2014 15:55:49 for ANIMA by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
