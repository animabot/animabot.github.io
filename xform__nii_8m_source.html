<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ANIMA: xform_nii.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ANIMA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5ce0a585544ccf90f6c4541b827e0dfc.html">anima-nightly-src</a></li><li class="navelem"><a class="el" href="dir_0fad36fe10bbcca9e7c6f0593f8115a7.html">filtering</a></li><li class="navelem"><a class="el" href="dir_a8c965e58a3e16f0722aea8ebc1f2ff0.html">nyul_standardization</a></li><li class="navelem"><a class="el" href="dir_369872ed032a3cd8f5543300e1c0f96c.html">matlab_intensity_standardization</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">xform_nii.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="xform__nii_8m.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;%  <span class="keyword">internal</span> <span class="keyword">function</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#aacacf50c8b45a3f09dbd6b2dd5a21bf6">    3</a></span>&#160;%  <span class="stringliteral">&#39;xform_nii.m&#39;</span> is an <span class="keyword">internal</span> <span class="keyword">function</span> called by <span class="stringliteral">&quot;load_nii.m&quot;</span>, so</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;%  you <span class="keywordflow">do</span> <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> need run <span class="keyword">this</span> <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a> by yourself. It does simplified</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;%  NIfTI sform/<a class="code" href="xform__nii_8m.html#a5cb6f57e0e8b329c031b64c318559426">qform</a> affine <a class="code" href="xform__nii_8m.html#a35e6130bb6ae8c0bbc86ae3e894b4222">transform</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> supports some of the </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;%  affine <a class="code" href="xform__nii_8m.html#ab514b5f78b1accaf0754f4c70dbb21a1">transforms</a>, including <a class="code" href="xform__nii_8m.html#aacacf50c8b45a3f09dbd6b2dd5a21bf6">translation</a>, <a class="code" href="xform__nii_8m.html#aa602d694ac4a8ed675ce4f3fd3373c6c">reflection</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;%  orthogonal <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a> (N*90 degree).</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;%</div>
<div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#aa482cfed4344666db363eea1adf51427">    9</a></span>&#160;%  For other affine <a class="code" href="xform__nii_8m.html#ab514b5f78b1accaf0754f4c70dbb21a1">transforms</a>, <a class="code" href="xform__nii_8m.html#a5389c938d8f439f89bc6549e6a18285d">e</a>.g. any degree <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a>, shearing</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;%  etc. you will have to use the included <span class="stringliteral">&#39;reslice_nii.m&#39;</span> <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;%  to reslice the <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a> volume. <span class="stringliteral">&#39;reslice_nii.m&#39;</span> is <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> called by</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;%  any other <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a>, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> you have to run <span class="stringliteral">&#39;reslice_nii.m&#39;</span> explicitly</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;%  <span class="keywordflow">for</span> those NIfTI files <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> you want to reslice them.</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;%</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;%  Since <span class="stringliteral">&#39;xform_nii.m&#39;</span> does <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> involve any interpolation or any</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;%  slice <a class="code" href="xform__nii_8m.html#a436f30a0a0000d67d5c56b6e36a2a606">change</a>, the original <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a> volume is supposed to be</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;%  <a class="code" href="xform__nii_8m.html#aa482cfed4344666db363eea1adf51427">untouched</a>, although it is <a class="code" href="xform__nii_8m.html#a3bb3ed58d0aa5922fd461c355b221337">translated</a>, <a class="code" href="xform__nii_8m.html#a087945111b3aa49887b612fc0a24a870">reflected</a>, or even </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;%  orthogonally <a class="code" href="xform__nii_8m.html#a3e7826f60c8b041e8f685e93902e14ee">rotated</a>, based on the affine matrix in the</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;%  NIfTI <a class="code" href="load__untouch__nii_8m.html#a5381cdd79f39b45eb8550689cc700aac">header</a>.</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;%</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;%  <a class="code" href="xform__nii_8m.html#a070fea3895f133851ed0ea4599f52886">However</a>, the affine matrix in the <a class="code" href="load__untouch__nii_8m.html#a5381cdd79f39b45eb8550689cc700aac">header</a> of <a class="code" href="xform__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> lot NIfTI files</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;%  contain slightly non-orthogonal <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a>. Therefore, optional</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;%  input parameter &#39;tolerance&#39; is used to allow some distortion</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;%  in the loaded <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a> <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> any non-orthogonal <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a> or shearing</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;%  of NIfTI affine matrix. If you set &#39;tolerance&#39; to 0, it <a class="code" href="hellier__hist__normalization__gmm_8m.html#ae1faaa3fedc82a59c523a5f60b2e900f">means</a></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;%  <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> you do <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> allow any distortion. If you set &#39;tolerance&#39; to</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;%  1, it <a class="code" href="hellier__hist__normalization__gmm_8m.html#ae1faaa3fedc82a59c523a5f60b2e900f">means</a> <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> you do <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> care any distortion. The <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a> will</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;%  fail to be loaded <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> it can <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> be tolerated. The tolerance will</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;%  be set to 0.1 (10%), <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> it is default or empty.</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;%</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;%  Because &#39;reslice_nii.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39; has to perform 3D interpolation, it can</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;%  be slow depending on <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a> size <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> affine matrix in the <a class="code" href="load__untouch__nii_8m.html#a5381cdd79f39b45eb8550689cc700aac">header</a>.</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;%  </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;%  After you perform the affine <a class="code" href="xform__nii_8m.html#a35e6130bb6ae8c0bbc86ae3e894b4222">transform</a>, the &#39;<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>&#39; structure</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;%  generated from &#39;xform_nii.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39; or new NIfTI file created from</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;%  &#39;reslice_nii.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39; will be in RAS <a class="code" href="load__untouch__nii_8m.html#ad601cae513dcbc91f7b5ccb0101bac22">orientation</a>, <a class="code" href="xform__nii_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>.<a class="code" href="xform__nii_8m.html#a5389c938d8f439f89bc6549e6a18285d">e</a>. X axis from</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;%  Left to Right, Y axis from Posterior to Anterior, <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> Z axis</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;%  from Inferior to Superior.</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;%</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;%  <a class="code" href="hellier__hist__normalization__gmm_8m.html#a81e12916b4d3e68242f0ac25c3ff1035">NOTE</a>: This function should be called immediately after load_nii.</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;%  </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;%  Usage: [ nii ] = xform_nii(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>, [tolerance], [<a class="code" href="xform__nii_8m.html#ab2ffebffc4896f5e6e6d3582ced1fbd9">preferredForm</a>])</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;%  </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;%  nii  - NIFTI structure (returned from load_nii)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;%</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;%  tolerance (optional) - distortion allowed for non-orthogonal rotation</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;%   or shearing in NIfTI affine matrix. It will be set to 0.1 (10%),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;%   if it is default or empty.</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;%</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;%  preferredForm (optional)  -  selects which transformation from voxels</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#afe106eb99aa948b70ba9ff453d1cde80">   51</a></span>&#160;%   to RAS coordinates; values are <a class="code" href="xform__nii_8m.html#a1af5497f0d80ec2d3e57945765f73d8c">s</a>,<a class="code" href="xform__nii_8m.html#a402668afa73f28e7643901afacaeca4c">q</a>,<a class="code" href="xform__nii_8m.html#afe106eb99aa948b70ba9ff453d1cde80">S</a>,Q.  Lower <span class="keywordflow">case</span> <a class="code" href="xform__nii_8m.html#a1af5497f0d80ec2d3e57945765f73d8c">s</a>,<a class="code" href="xform__nii_8m.html#a402668afa73f28e7643901afacaeca4c">q</a> indicate</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;%   <span class="stringliteral">&quot;prefer sform or qform, but use others if preferred not present&quot;</span>. </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;%   Upper <span class="keywordflow">case</span> indicate the <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a> is forced to use the specificied</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;%   tranform or fail loading.  <span class="stringliteral">&#39;preferredForm&#39;</span> will be <span class="charliteral">&#39;s&#39;</span>, <span class="keywordflow">if</span> it is</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;%   <span class="keywordflow">default</span> or empty.   - Jeff Gunter</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;%  </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;%  NIFTI data format can be found on: http:<span class="comment">//nifti.nimh.nih.gov</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;%</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;%  - Jimmy Shen (jimmy@rotman-baycrest.on.ca)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;%</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;function nii = xform_nii(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>, tolerance, <a class="code" href="xform__nii_8m.html#ab2ffebffc4896f5e6e6d3582ced1fbd9">preferredForm</a>)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   %  save a copy of the header as it was loaded.  This is the</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   %  header before any sform, qform manipulation is done.</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   %</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   nii.original.hdr = nii.hdr;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordflow">if</span> <a class="code" href="xform__nii_8m.html#a60fced9075c57d0553766459f9138570">~exist</a>(<span class="stringliteral">&#39;tolerance&#39;</span>,<span class="stringliteral">&#39;var&#39;</span>) | isempty(tolerance)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      tolerance = 0.1;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <a class="code" href="xform__nii_8m.html#ac6bc8350140b19d063e04417eeab8230">elseif</a>(tolerance&lt;=0)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      tolerance = eps;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> ~exist(&#39;<a class="code" href="xform__nii_8m.html#ab2ffebffc4896f5e6e6d3582ced1fbd9">preferredForm</a>&#39;,&#39;var&#39;) | isempty(preferredForm)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      preferredForm= &#39;<a class="code" href="xform__nii_8m.html#a1af5497f0d80ec2d3e57945765f73d8c">s</a>&#39;;               % Jeff</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a9fa90427dcfbd3842b66764f038bcbeb">   78</a></span>&#160;   %  <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#ac1f63242dd36df9da920d8a23ad5c84c">scl_slope</a> field is <a class="code" href="xform__nii_8m.html#a9fa90427dcfbd3842b66764f038bcbeb">nonzero</a>, then each voxel value in the</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   %  <a class="code" href="load__untouch__nii_8m.html#ac238b270f83f7fdcb757309812fa28c5">dataset</a> should be scaled <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a>: y = <a class="code" href="xform__nii_8m.html#ac1f63242dd36df9da920d8a23ad5c84c">scl_slope</a> * x + scl_inter</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   %  I bring it here because <a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a> will be modified by change_hdr.</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   %</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#ac1f63242dd36df9da920d8a23ad5c84c">scl_slope</a> ~= 0 &amp; ...</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    ismember(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#a541df6bf052f2efc7a949725e1c247f6">datatype</a>, [2,4,8,16,64,256,512,768]) &amp; ...</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ac1f63242dd36df9da920d8a23ad5c84c">   84</a></span>&#160;    (<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#ac1f63242dd36df9da920d8a23ad5c84c">scl_slope</a> ~= 1 | <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.scl_inter ~= 0)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a> = ...</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#ac1f63242dd36df9da920d8a23ad5c84c">scl_slope</a> * <span class="keywordtype">double</span>(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a>) + <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.scl_inter;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a541df6bf052f2efc7a949725e1c247f6">   89</a></span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.datatype == 64</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;         <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.datatype = 64;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ae9a659ee1c9ae19c4f8c8c8c9aa072c0">   92</a></span>&#160;         <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#ae9a659ee1c9ae19c4f8c8c8c9aa072c0">bitpix</a> = 64;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#adc359efc23ea39d0411c481c3123f64b">   94</a></span>&#160;         <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a> = single(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;         <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.datatype = 16;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;         <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.bitpix = 32;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ad07d284a896de58ddcaa088799d032c7">  100</a></span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#ad07d284a896de58ddcaa088799d032c7">glmax</a> = max(<span class="keywordtype">double</span>(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:)));</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#afdf31327ed81468d66cf6bf1ab1a9e2a">  101</a></span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#afdf31327ed81468d66cf6bf1ab1a9e2a">glmin</a> = min(<span class="keywordtype">double</span>(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:)));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      %  set scale to non-use, because it is applied in xform_nii</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      %</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#ac1f63242dd36df9da920d8a23ad5c84c">scl_slope</a> = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a6c2f4e523c936b7725a67fb12691ab13">  109</a></span>&#160;   %  <a class="code" href="xform__nii_8m.html#a070fea3895f133851ed0ea4599f52886">However</a>, the scaling is to be ignored <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> datatype is DT_RGB24.</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   %  If datatype is <a class="code" href="xform__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> complex <a class="code" href="xform__nii_8m.html#a6c2f4e523c936b7725a67fb12691ab13">type</a>, then the scaling is to be applied</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   %  to both the real <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> imaginary parts.</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   %</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.scl_slope ~= 0 &amp; ...</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ismember(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.datatype, [32,1792])</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img = ...</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.scl_slope * <span class="keywordtype">double</span>(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img) + <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.scl_inter;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.datatype == 32</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;         <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img = single(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#ad07d284a896de58ddcaa088799d032c7">glmax</a> = max(<span class="keywordtype">double</span>(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:)));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.<a class="code" href="xform__nii_8m.html#afdf31327ed81468d66cf6bf1ab1a9e2a">glmin</a> = min(<span class="keywordtype">double</span>(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:)));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      %  set scale to non-use, because it is applied in xform_nii</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      %</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.dime.scl_slope = 0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   %  There is no need <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> this <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a> to <a class="code" href="xform__nii_8m.html#a35e6130bb6ae8c0bbc86ae3e894b4222">transform</a> Analyze data</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   %</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a7a6151189c42255ed2727c0c65bd8860">  135</a></span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a7a6151189c42255ed2727c0c65bd8860">filetype</a> == 0 &amp; exist([<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="load__nii__ext_8m.html#aff247e90c6608215c92679f8aa390e10">fileprefix</a> &#39;.mat&#39;],&#39;file&#39;)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      load([<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="load__nii__ext_8m.html#aff247e90c6608215c92679f8aa390e10">fileprefix</a> &#39;.mat&#39;]);    % old SPM affine matrix</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a6b45d48125a6b8b1ee140eed24a0419f">  137</a></span>&#160;      <a class="code" href="xform__nii_8m.html#a6b45d48125a6b8b1ee140eed24a0419f">R</a>=<a class="code" href="xform__nii_8m.html#add7e617330774ae8bc6b4cd8c67b65b4">M</a>(1:3,1:3);</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#adf1f3edb9115acb0a1e04209b7a9937b">  138</a></span>&#160;      <a class="code" href="xform__nii_8m.html#adf1f3edb9115acb0a1e04209b7a9937b">T</a>=M(1:3,4);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="xform__nii_8m.html#adf1f3edb9115acb0a1e04209b7a9937b">T</a>=<a class="code" href="xform__nii_8m.html#a6b45d48125a6b8b1ee140eed24a0419f">R</a>*ones(3,1)+<a class="code" href="xform__nii_8m.html#adf1f3edb9115acb0a1e04209b7a9937b">T</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      M(1:3,4)=T;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a319684c14641b1e61c5abf9fa5888b97">  141</a></span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a319684c14641b1e61c5abf9fa5888b97">qform_code</a>=0;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a7faa578ac30a502075bbd6528ca570a8">  142</a></span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a7faa578ac30a502075bbd6528ca570a8">sform_code</a>=1;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#afaec44be68b4dd7d69cd18070f541993">  143</a></span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#afaec44be68b4dd7d69cd18070f541993">srow_x</a>=M(1,:);</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a83e89a30b9d250f312ba7c0ee122ead8">  144</a></span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a83e89a30b9d250f312ba7c0ee122ead8">srow_y</a>=M(2,:);</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a448a15a66934cebb54a54153e3fe6ba9">  145</a></span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a448a15a66934cebb54a54153e3fe6ba9">srow_z</a>=M(3,:);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <a class="code" href="xform__nii_8m.html#ac6bc8350140b19d063e04417eeab8230">elseif</a> <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a7a6151189c42255ed2727c0c65bd8860">filetype</a> == 0</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#afd6ce22ae5ea522c4e91b48d6d72c195">rot_orient</a> = [];</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a40d1b807f01e4896b3281cc7b7277300">  148</a></span>&#160;      <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a40d1b807f01e4896b3281cc7b7277300">flip_orient</a> = [];</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a20e1746bf8fab881987958cd24f9cf6f">  149</a></span>&#160;      <a class="code" href="xform__nii_8m.html#a20e1746bf8fab881987958cd24f9cf6f">return</a>;               % no sform/<a class="code" href="xform__nii_8m.html#a5cb6f57e0e8b329c031b64c318559426">qform</a> <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> Analyze format</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">  152</a></span>&#160;   <a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a> = <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.<a class="code" href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   [hdr,<a class="code" href="xform__nii_8m.html#a3e2df7a11ee5b0b768b870c65b42e33f">orient</a>]=change_hdr(hdr,tolerance,preferredForm);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   %  <a class="code" href="xform__nii_8m.html#ac1dee459aca75cb3082c5d6534aa74ef">flip</a> <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a>/or rotate <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a> data</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   %</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> ~<a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(<a class="code" href="xform__nii_8m.html#a3e2df7a11ee5b0b768b870c65b42e33f">orient</a>, [1 2 3])</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      old_dim = hdr.dime.<a class="code" href="xform__nii_8m.html#a209706a3986f2715bddabe919088e00e">dim</a>([2:4]);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      %  More than 1 time frame</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      %</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#aacab4845605c8da426d11f687fabeabe">ndims</a>(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img) &gt; 3</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;         <a class="code" href="xform__nii_8m.html#a7eb778c471c5522fe3f4b7ebdc4c0760">pattern</a> = 1:prod(old_dim);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a7eb778c471c5522fe3f4b7ebdc4c0760">  167</a></span>&#160;         <a class="code" href="xform__nii_8m.html#a7eb778c471c5522fe3f4b7ebdc4c0760">pattern</a> = [];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> ~isempty(<a class="code" href="xform__nii_8m.html#a7eb778c471c5522fe3f4b7ebdc4c0760">pattern</a>)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         <a class="code" href="xform__nii_8m.html#a7eb778c471c5522fe3f4b7ebdc4c0760">pattern</a> = reshape(<a class="code" href="xform__nii_8m.html#a7eb778c471c5522fe3f4b7ebdc4c0760">pattern</a>, old_dim);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      %  calculate <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a> after <a class="code" href="xform__nii_8m.html#ac1dee459aca75cb3082c5d6534aa74ef">flip</a></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      %</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#afd6ce22ae5ea522c4e91b48d6d72c195">  176</a></span>&#160;      rot_orient = mod(orient + 2, 3) + 1;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      %  do <a class="code" href="xform__nii_8m.html#ac1dee459aca75cb3082c5d6534aa74ef">flip</a>:</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      %</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ac1dee459aca75cb3082c5d6534aa74ef">  180</a></span>&#160;      flip_orient = orient - rot_orient;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">  182</a></span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> <a class="code" href="xform__nii_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a> = 1:3</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> flip_orient(<a class="code" href="xform__nii_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> ~isempty(pattern)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;               pattern = flipdim(pattern, <a class="code" href="xform__nii_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;               <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img = flipdim(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img, i);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;         <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      %  get index of orient (rotate inversely)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      %</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      [<a class="code" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a> rot_orient] = sort(rot_orient);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#aee34f1464f1bbd47259504a32b8639f5">  196</a></span>&#160;      <a class="code" href="xform__nii_8m.html#aee34f1464f1bbd47259504a32b8639f5">new_dim</a> = old_dim;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <a class="code" href="xform__nii_8m.html#aee34f1464f1bbd47259504a32b8639f5">new_dim</a> = <a class="code" href="xform__nii_8m.html#aee34f1464f1bbd47259504a32b8639f5">new_dim</a>(rot_orient);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      hdr.dime.dim([2:4]) = <a class="code" href="xform__nii_8m.html#aee34f1464f1bbd47259504a32b8639f5">new_dim</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#afc699248477dde48350fe94448b89504">  200</a></span>&#160;      <a class="code" href="xform__nii_8m.html#afc699248477dde48350fe94448b89504">new_pixdim</a> = hdr.dime.<a class="code" href="xform__nii_8m.html#a9fa650ab4f9794082e0915dfa7306d8f">pixdim</a>([2:4]);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="xform__nii_8m.html#afc699248477dde48350fe94448b89504">new_pixdim</a> = <a class="code" href="xform__nii_8m.html#afc699248477dde48350fe94448b89504">new_pixdim</a>(rot_orient);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      hdr.dime.pixdim([2:4]) = <a class="code" href="xform__nii_8m.html#afc699248477dde48350fe94448b89504">new_pixdim</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      %  re-calculate <a class="code" href="xform__nii_8m.html#a5c64f97f406d865a23cef0e15368a61f">originator</a></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      %</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a> = hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a5c64f97f406d865a23cef0e15368a61f">originator</a>([1:3]);</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">  207</a></span>&#160;      <a class="code" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a> = <a class="code" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a>(rot_orient);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      flip_orient = flip_orient(rot_orient);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> i = 1:3</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> flip_orient(i) &amp; ~<a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(<a class="code" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a>(i), 0)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <a class="code" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a>(i) = new_dim(i) - <a class="code" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a>(i) + 1;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;         <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.originator([1:3]) = <a class="code" href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.rot_orient = rot_orient;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.flip_orient = flip_orient;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      %  do <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a>:</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      %</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> ~isempty(pattern)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         pattern = permute(pattern, rot_orient);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         pattern = pattern(:);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> hdr.dime.datatype == 32 | hdr.dime.datatype == 1792 | ...</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        hdr.dime.datatype == 128 | hdr.dime.datatype == 511</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            tmp = reshape(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,1), [prod(new_dim) hdr.dime.dim(5:8)]);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            tmp = tmp(pattern, :);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,1) = reshape(tmp, [new_dim       hdr.dime.dim(5:8)]);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            tmp = reshape(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,2), [prod(new_dim) hdr.dime.dim(5:8)]);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            tmp = tmp(pattern, :);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,2) = reshape(tmp, [new_dim       hdr.dime.dim(5:8)]);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> hdr.dime.datatype == 128 | hdr.dime.datatype == 511</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;               tmp = reshape(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,3), [prod(new_dim) hdr.dime.dim(5:8)]);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;               tmp = tmp(pattern, :);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;               <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,3) = reshape(tmp, [new_dim       hdr.dime.dim(5:8)]);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;         <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img = reshape(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img, [prod(new_dim) hdr.dime.dim(5:8)]);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img = <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(pattern, :);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img = reshape(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img, [new_dim       hdr.dime.dim(5:8)]);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;         <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> hdr.dime.datatype == 32 | hdr.dime.datatype == 1792 | ...</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        hdr.dime.datatype == 128 | hdr.dime.datatype == 511</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,1) = permute(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,1), rot_orient);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,2) = permute(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,2), rot_orient);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> hdr.dime.datatype == 128 | hdr.dime.datatype == 511</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;               <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,3) = permute(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img(:,:,:,3), rot_orient);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img = permute(<a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.img, rot_orient);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;         <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.rot_orient = [];</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.flip_orient = [];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <a class="code" href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a>.hdr = hdr;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <a class="code" href="xform__nii_8m.html#a20e1746bf8fab881987958cd24f9cf6f">return</a>;                  % xform_nii</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;%-----------------------------------------------------------------------</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<a class="code" href="emgm_8m.html#a67531ee5e31b1d1a3065cf637eae4546">function</a> [hdr, orient] = change_hdr(hdr, tolerance, preferredForm)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   orient = [1 2 3];</div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ab74f5431bce53baaa41c0e31666c7363">  276</a></span>&#160;   <a class="code" href="xform__nii_8m.html#ab74f5431bce53baaa41c0e31666c7363">affine_transform</a> = 1;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   %  NIFTI can have both sform <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> <a class="code" href="xform__nii_8m.html#a5cb6f57e0e8b329c031b64c318559426">qform</a> <a class="code" href="xform__nii_8m.html#a35e6130bb6ae8c0bbc86ae3e894b4222">transform</a>. This <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   %  will check sform_code prior to qform_code by default.</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   %</div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ab2ffebffc4896f5e6e6d3582ced1fbd9">  281</a></span>&#160;   %  If user specifys &quot;preferredForm&quot;, user can then choose the</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   %  priority.                 - Jeff</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   %</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <a class="code" href="xform__nii_8m.html#a81831abe21f43a3029193d0400d2e286">useForm</a>=[];                  % Jeff</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(preferredForm,&#39;<a class="code" href="xform__nii_8m.html#afe106eb99aa948b70ba9ff453d1cde80">S</a>&#39;)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;       <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.sform_code,0)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;           <a class="code" href="xform__nii_8m.html#a8e15b42ec8048cd948e07f776628ac2d">error</a>(&#39;User requires sform, sform <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> set in <a class="code" href="load__untouch__nii_8m.html#a5381cdd79f39b45eb8550689cc700aac">header</a>&#39;);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;       <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a81831abe21f43a3029193d0400d2e286">  290</a></span>&#160;           useForm=&#39;s&#39;;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;       <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>                      % Jeff</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(preferredForm,&#39;Q&#39;)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;       <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.qform_code,0)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;           <a class="code" href="xform__nii_8m.html#a8e15b42ec8048cd948e07f776628ac2d">error</a>(&#39;User requires <a class="code" href="xform__nii_8m.html#a5cb6f57e0e8b329c031b64c318559426">qform</a>, qform <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> set in header&#39;);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;       <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;           useForm=&#39;<a class="code" href="xform__nii_8m.html#a402668afa73f28e7643901afacaeca4c">q</a>&#39;;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;       <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>                      % Jeff</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(preferredForm,&#39;s&#39;)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;       <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.sform_code &gt; 0</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;           useForm=&#39;s&#39;;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;       <a class="code" href="xform__nii_8m.html#ac6bc8350140b19d063e04417eeab8230">elseif</a> hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.qform_code &gt; 0</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;           useForm=&#39;q&#39;;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;       <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>                      % Jeff</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(preferredForm,&#39;q&#39;)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;       <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.qform_code &gt; 0</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;           useForm=&#39;q&#39;;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;       <a class="code" href="xform__nii_8m.html#ac6bc8350140b19d063e04417eeab8230">elseif</a> hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.sform_code &gt; 0</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;           useForm=&#39;s&#39;;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;       <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>                      % Jeff</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(useForm,&#39;s&#39;)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="xform__nii_8m.html#a6b45d48125a6b8b1ee140eed24a0419f">R</a> = [hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#afaec44be68b4dd7d69cd18070f541993">srow_x</a>(1:3)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;           hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a83e89a30b9d250f312ba7c0ee122ead8">srow_y</a>(1:3)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;           hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a448a15a66934cebb54a54153e3fe6ba9">srow_z</a>(1:3)];</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      T = [hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#afaec44be68b4dd7d69cd18070f541993">srow_x</a>(4)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;           hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#a83e89a30b9d250f312ba7c0ee122ead8">srow_y</a>(4)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;           hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.srow_z(4)];</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#a1f3fb972d2721a5ebac11058d4a3228f">det</a>(<a class="code" href="xform__nii_8m.html#a6b45d48125a6b8b1ee140eed24a0419f">R</a>) == 0 | ~<a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(<a class="code" href="xform__nii_8m.html#a6b45d48125a6b8b1ee140eed24a0419f">R</a>(find(<a class="code" href="xform__nii_8m.html#a6b45d48125a6b8b1ee140eed24a0419f">R</a>)), sum(R)&#39;)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="reslice__nii_8m.html#a7a252e0f4bf7885d8d4789b1b1066aab">old_affine</a> = [ [R;[0 0 0]] [T;1] ];</div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a3dfb20bb83a99a0ca0755ef56b1fd4a9">  329</a></span>&#160;         <a class="code" href="xform__nii_8m.html#a3dfb20bb83a99a0ca0755ef56b1fd4a9">R_sort</a> = sort(abs(R(:)));</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         R( find( abs(R) &lt; tolerance*min(<a class="code" href="xform__nii_8m.html#a3dfb20bb83a99a0ca0755ef56b1fd4a9">R_sort</a>(<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>-2:<a class="code" href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a>)) ) ) = 0;</div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ad23889dc5dd027154839396ddeb4343c">  331</a></span>&#160;         hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#ad23889dc5dd027154839396ddeb4343c">new_affine</a> = [ [R;[0 0 0]] [T;1] ];</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;         <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#a1f3fb972d2721a5ebac11058d4a3228f">det</a>(R) == 0 | ~<a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(R(find(R)), sum(R)&#39;)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10) &#39;   Non-orthogonal <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a> or shearing &#39;];</div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">  335</a></span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;found inside the affine matrix&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;   in this NIfTI file. You have 3 options:&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;   1. Using included &#39;&#39;reslice_nii.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39;&#39; <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a> to reslice the NIfTI&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;      file. I strongly recommand this, because it will <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> cause&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;      negative effect, <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> <span class="keywordtype">long</span> <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> you remember <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> to do slice&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;      time correction after using &#39;&#39;reslice_nii.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39;&#39;.&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;   2. Using included &#39;&#39;<a class="code" href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a>.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39;&#39; <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a> to load <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a>&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;      without applying any affine geometric transformation or&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;      voxel intensity scaling. This is only <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> people who want&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;      to do some <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a> processing regardless of <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a> <a class="code" href="load__untouch__nii_8m.html#ad601cae513dcbc91f7b5ccb0101bac22">orientation</a>&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> to <a class="code" href="save__untouch__nii_8m.html#a5acb2d0a726641d28d07836ce7824f58">save</a> data back with the same NIfTI header.&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;   3. Increasing the tolerance to allow more distortion in loaded&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;      <a class="code" href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a>, but I don&#39;&#39;<a class="code" href="emgm_8m.html#aaccc9105df5383111407fd5b41255e23">t</a> suggest this.&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;   To get help, please type:&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10) &#39;   help reslice_nii.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = [<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> &#39;   help <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a>.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39; <span class="keywordtype">char</span>(10) &#39;   help load_nii.<a class="code" href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a>&#39;];</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <a class="code" href="xform__nii_8m.html#a8e15b42ec8048cd948e07f776628ac2d">error</a>(<a class="code" href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;         end</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      end</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <a class="code" href="xform__nii_8m.html#ac6bc8350140b19d063e04417eeab8230">elseif</a> <a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(useForm,&#39;q&#39;)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      b = hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.quatern_b;</div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">  356</a></span>&#160;      <a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a> = hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.quatern_c;</div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">  357</a></span>&#160;      <a class="code" href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a> = hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.quatern_d;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> 1.0-(b*b+<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>+<a class="code" href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>*<a class="code" href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>) &lt; 0</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> abs(1.0-(b*b+<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>+<a class="code" href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>*<a class="code" href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>)) &lt; 1<a class="code" href="xform__nii_8m.html#a5389c938d8f439f89bc6549e6a18285d">e</a>-5</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <a class="code" href="xform__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a> = 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;         <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <a class="code" href="xform__nii_8m.html#a8e15b42ec8048cd948e07f776628ac2d">error</a>(&#39;Incorrect quaternion values in this NIFTI data.&#39;);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;         end</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">  366</a></span>&#160;         a = sqrt(1.0-(b*b+<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>+<a class="code" href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>*<a class="code" href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      end</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a969b424c4d5ee8841704d2c431950747">  369</a></span>&#160;      <a class="code" href="xform__nii_8m.html#a969b424c4d5ee8841704d2c431950747">qfac</a> = hdr.dime.pixdim(1);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#a969b424c4d5ee8841704d2c431950747">qfac</a>==0, qfac = 1; end</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      i = hdr.dime.pixdim(2);</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">  372</a></span>&#160;      <a class="code" href="xform__nii_8m.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a> = hdr.dime.pixdim(3);</div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#adc468c70fb574ebd07287b38d0d0676d">  373</a></span>&#160;      <a class="code" href="xform__nii_8m.html#adc468c70fb574ebd07287b38d0d0676d">k</a> = qfac * hdr.dime.pixdim(4);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      R = [a*a+b*b-<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>-d*d     2*b*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>-2*a*d        2*b*d+2*a*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;           2*b*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>+2*a*d         a*a+<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>-b*b-d*d    2*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>*d-2*a*b</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;           2*b*d-2*a*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>         2*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>*d+2*a*b        a*a+d*d-<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>*<a class="code" href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>-b*b];</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      T = [hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.qoffset_x</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;           hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.qoffset_y</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;           hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.qoffset_z];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      %  qforms are expected to generate <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a> matrices R which are</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      %  <a class="code" href="xform__nii_8m.html#a1f3fb972d2721a5ebac11058d4a3228f">det</a>(R) = 1; we&#39;ll make sure <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> happens.</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      %  </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      %  now we make the same checks <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> were done above <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> sform data</div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a1dcbb39086f836d3198af29ebab02004">  387</a></span>&#160;      %  BUT we do it on a <a class="code" href="xform__nii_8m.html#a35e6130bb6ae8c0bbc86ae3e894b4222">transform</a> <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a> is in terms of voxels <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> <a class="code" href="xform__nii_8m.html#a1dcbb39086f836d3198af29ebab02004">mm</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      %  after we <a class="code" href="hellier__hist__normalization__gmm_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a> out the angles <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> squash them to closest </div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">  389</a></span>&#160;      %  rectilinear direction. After <a class="code" href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a>, the voxel sizes are then</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      %  added.</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      %</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      %  This part is modified by Jeff Gunter.</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      %</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#a1f3fb972d2721a5ebac11058d4a3228f">det</a>(R) == 0 | ~<a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(R(find(R)), sum(R)&#39;)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;         %  <a class="code" href="xform__nii_8m.html#a1f3fb972d2721a5ebac11058d4a3228f">det</a>(R) == 0 is <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> a common trigger <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> this ---</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         %  R(find(R)) is a list of non-zero elements in R; <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> that</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;         %  is <a class="code" href="xform__nii_8m.html#ae587f42cdc9c46cb65f6e56680d747a8">straight</a> (<a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> oblique) then it should be the same <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;         %  columnwise summation. Could just <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> well have checked the</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         %  lengths of R(find(R)) <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> sum(R)&#39; (which should be 3)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;         %</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="reslice__nii_8m.html#a7a252e0f4bf7885d8d4789b1b1066aab">old_affine</a> = [ [R * diag([i <a class="code" href="xform__nii_8m.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a> <a class="code" href="xform__nii_8m.html#adc468c70fb574ebd07287b38d0d0676d">k</a>]);[0 0 0]] [T;1] ];</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <a class="code" href="xform__nii_8m.html#a3dfb20bb83a99a0ca0755ef56b1fd4a9">R_sort</a> = sort(abs(R(:)));</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;         R( find( abs(R) &lt; tolerance*min(<a class="code" href="xform__nii_8m.html#a3dfb20bb83a99a0ca0755ef56b1fd4a9">R_sort</a>(end-2:end)) ) ) = 0;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;         R = R * diag([i <a class="code" href="xform__nii_8m.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a> k]);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;         hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.<a class="code" href="xform__nii_8m.html#ad23889dc5dd027154839396ddeb4343c">new_affine</a> = [ [R;[0 0 0]] [T;1] ];</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;         <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#a1f3fb972d2721a5ebac11058d4a3228f">det</a>(R) == 0 | ~<a class="code" href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a>(R(find(R)), sum(R)&#39;)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            msg = [<span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10) &#39;   Non-orthogonal <a class="code" href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a> or shearing &#39;];</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            msg = [msg &#39;found inside the affine matrix&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            msg = [msg &#39;   in this NIfTI file. You have 3 options:&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            msg = [msg &#39;   1. Using included &#39;&#39;reslice_nii.m&#39;&#39; <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a> to reslice the NIfTI&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            msg = [msg &#39;      file. I strongly recommand this, because it will <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> cause&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            msg = [msg &#39;      negative effect, <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> <span class="keywordtype">long</span> <a class="code" href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a> you remember <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> to do slice&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            msg = [msg &#39;      time correction after using &#39;&#39;reslice_nii.m&#39;&#39;.&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            msg = [msg &#39;   2. Using included &#39;&#39;<a class="code" href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a>.m&#39;&#39; <a class="code" href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a> to load image&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            msg = [msg &#39;      without applying any affine geometric transformation or&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            msg = [msg &#39;      voxel intensity scaling. This is only <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> people who want&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            msg = [msg &#39;      to do some image processing regardless of image <a class="code" href="load__untouch__nii_8m.html#ad601cae513dcbc91f7b5ccb0101bac22">orientation</a>&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            msg = [msg &#39;      <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> to <a class="code" href="save__untouch__nii_8m.html#a5acb2d0a726641d28d07836ce7824f58">save</a> data back with the same NIfTI header.&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            msg = [msg &#39;   3. Increasing the tolerance to allow more distortion in loaded&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            msg = [msg &#39;      image, but I don&#39;&#39;<a class="code" href="emgm_8m.html#aaccc9105df5383111407fd5b41255e23">t</a> suggest this.&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            msg = [msg &#39;   To get help, please type:&#39; <span class="keywordtype">char</span>(10) <span class="keywordtype">char</span>(10) &#39;   help reslice_nii.m&#39; <span class="keywordtype">char</span>(10)];</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            msg = [msg &#39;   help <a class="code" href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a>.m&#39; <span class="keywordtype">char</span>(10) &#39;   help load_nii.m&#39;];</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <a class="code" href="xform__nii_8m.html#a8e15b42ec8048cd948e07f776628ac2d">error</a>(msg);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;         end</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;         R = R * diag([i <a class="code" href="xform__nii_8m.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a> k]);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      end                   % 1st <a class="code" href="xform__nii_8m.html#a1f3fb972d2721a5ebac11058d4a3228f">det</a>(R)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <a class="code" href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="xform__nii_8m.html#ab74f5431bce53baaa41c0e31666c7363">affine_transform</a> = 0; % no sform or qform <a class="code" href="xform__nii_8m.html#a35e6130bb6ae8c0bbc86ae3e894b4222">transform</a></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   end</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> affine_transform == 1</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      voxel_size = abs(sum(R,1));</div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a163c377951eed58bd62de80899df089b">  438</a></span>&#160;      <a class="code" href="xform__nii_8m.html#a163c377951eed58bd62de80899df089b">inv_R</a> = inv(R);</div>
<div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a5c64f97f406d865a23cef0e15368a61f">  439</a></span>&#160;      originator = <a class="code" href="xform__nii_8m.html#a163c377951eed58bd62de80899df089b">inv_R</a>*(-T)+1;</div>
<div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a3e2df7a11ee5b0b768b870c65b42e33f">  440</a></span>&#160;      orient = get_orient(<a class="code" href="xform__nii_8m.html#a163c377951eed58bd62de80899df089b">inv_R</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      %  modify pixdim <a class="code" href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a> originator</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      %</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      hdr.dime.pixdim(2:4) = voxel_size;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.originator(1:3) = originator;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      %  set sform or qform to non-use, because they have been</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      %  applied in xform_nii</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      %</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.qform_code = 0;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      hdr.<a class="code" href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a>.sform_code = 0;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   end</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   %  apply <a class="code" href="xform__nii_8m.html#ade6e498f1ab724790b30502a59c7d186">space_unit</a> to pixdim <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a> 1 (mm)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   %</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   <a class="code" href="xform__nii_8m.html#ade6e498f1ab724790b30502a59c7d186">space_unit</a> = get_units(hdr);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ade6e498f1ab724790b30502a59c7d186">  458</a></span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a> <a class="code" href="xform__nii_8m.html#ade6e498f1ab724790b30502a59c7d186">space_unit</a> ~= 1</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      hdr.dime.pixdim(2:4) = hdr.dime.pixdim(2:4) * <a class="code" href="xform__nii_8m.html#ade6e498f1ab724790b30502a59c7d186">space_unit</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a4068c1b4f259ced4d5ad4c6762c715eb">  461</a></span>&#160;      %  set space_unit of <a class="code" href="xform__nii_8m.html#a2b76768e294588fbdaf82b55a8273f6a">xyzt_units</a> to <a class="code" href="xform__nii_8m.html#a4068c1b4f259ced4d5ad4c6762c715eb">millimeter</a>, because</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      %  voxel_size has been re-scaled</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      %</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      hdr.dime.<a class="code" href="xform__nii_8m.html#a2b76768e294588fbdaf82b55a8273f6a">xyzt_units</a> = <span class="keywordtype">char</span>(bitset(hdr.dime.<a class="code" href="xform__nii_8m.html#a2b76768e294588fbdaf82b55a8273f6a">xyzt_units</a>,1,0));</div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a2b76768e294588fbdaf82b55a8273f6a">  465</a></span>&#160;      hdr.dime.xyzt_units = <span class="keywordtype">char</span>(bitset(hdr.dime.xyzt_units,2,1));</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      hdr.dime.xyzt_units = <span class="keywordtype">char</span>(bitset(hdr.dime.xyzt_units,3,0));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   end</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a9fa650ab4f9794082e0915dfa7306d8f">  469</a></span>&#160;   hdr.dime.pixdim = abs(hdr.dime.pixdim);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <a class="code" href="xform__nii_8m.html#a20e1746bf8fab881987958cd24f9cf6f">return</a>;                  % change_hdr</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;%-----------------------------------------------------------------------</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<a class="code" href="emgm_8m.html#a67531ee5e31b1d1a3065cf637eae4546">function</a> orient = get_orient(R)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   orient = [];</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   <a class="code" href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a> i = 1:3</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      switch find(R(i,:)) * sign(sum(R(i,:)))</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> 1</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;         orient = [orient 1];       % Left to Right</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> 2</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;         orient = [orient 2];       % Posterior to Anterior</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> 3</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;         orient = [orient 3];       % Inferior to Superior</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> -1</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         orient = [orient 4];       % Right to Left</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> -2</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;         orient = [orient 5];       % Anterior to Posterior</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> -3</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;         orient = [orient 6];       % Superior to Inferior</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      end</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   end</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <a class="code" href="xform__nii_8m.html#a20e1746bf8fab881987958cd24f9cf6f">return</a>;                  % get_orient</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;%-----------------------------------------------------------------------</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<a class="code" href="emgm_8m.html#a67531ee5e31b1d1a3065cf637eae4546">function</a> [space_unit, <a class="code" href="xform__nii_8m.html#afa9804529d0f2f5215cb7f51e8bff526">time_unit</a>] = get_units(hdr)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   switch <a class="code" href="xform__nii_8m.html#a340b9e1a6a0f19cb437a822e83622181">bitand</a>(hdr.dime.xyzt_units, 7)    % mask with 0x07</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> 1</div>
<div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#af029974ae4b9824ec0773756fab0f47a">  504</a></span>&#160;      space_unit = 1<a class="code" href="xform__nii_8m.html#a5389c938d8f439f89bc6549e6a18285d">e</a>+3;        % <a class="code" href="xform__nii_8m.html#af029974ae4b9824ec0773756fab0f47a">meter</a>, m</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> 3</div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#a13f682352dafa4d40a7ae9ed801e96e6">  506</a></span>&#160;      space_unit = 1e-3;        % <a class="code" href="xform__nii_8m.html#a13f682352dafa4d40a7ae9ed801e96e6">micrometer</a>, um</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   otherwise</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      space_unit = 1;           % millimeter, mm</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   end</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   switch <a class="code" href="xform__nii_8m.html#a340b9e1a6a0f19cb437a822e83622181">bitand</a>(hdr.dime.xyzt_units, 56)   % mask with 0x38</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> 16</div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#ad14d98cdcfa4397ac3a0af6ce942c55d">  513</a></span>&#160;      <a class="code" href="xform__nii_8m.html#afa9804529d0f2f5215cb7f51e8bff526">time_unit</a> = 1e-3;         % <a class="code" href="xform__nii_8m.html#ad14d98cdcfa4397ac3a0af6ce942c55d">millisecond</a>, ms</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <a class="code" href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a> 24</div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#afa9804529d0f2f5215cb7f51e8bff526">  515</a></span>&#160;      <a class="code" href="xform__nii_8m.html#afa9804529d0f2f5215cb7f51e8bff526">time_unit</a> = 1e-6;         % <a class="code" href="xform__nii_8m.html#aec46df66b2e4c26c5340d523471db40f">microsecond</a>, us</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   otherwise</div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="xform__nii_8m.html#acfd440223f806c44323dbd1053b99123">  517</a></span>&#160;      <a class="code" href="xform__nii_8m.html#afa9804529d0f2f5215cb7f51e8bff526">time_unit</a> = 1;            % <a class="code" href="xform__nii_8m.html#acfd440223f806c44323dbd1053b99123">second</a>, s</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   end</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   return;                  % get_units</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ab66251c08e0241221a1f306f8c4760f5"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ab66251c08e0241221a1f306f8c4760f5">if</a></div><div class="ttdeci">Check the ordering of the means if(mu_i_first_subset&lt; mu_i_second_subset &amp;mu_i_first_subset&lt; mu_i_third_subset) disp('The first Gaussian is the CSF')</div></div>
<div class="ttc" id="xform__nii_8m_html_a81831abe21f43a3029193d0400d2e286"><div class="ttname"><a href="xform__nii_8m.html#a81831abe21f43a3029193d0400d2e286">useForm</a></div><div class="ttdeci">else useForm</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00290">xform_nii.m:290</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a163c377951eed58bd62de80899df089b"><div class="ttname"><a href="xform__nii_8m.html#a163c377951eed58bd62de80899df089b">inv_R</a></div><div class="ttdeci">inv_R</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00438">xform_nii.m:438</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a3bb3ed58d0aa5922fd461c355b221337"><div class="ttname"><a href="xform__nii_8m.html#a3bb3ed58d0aa5922fd461c355b221337">translated</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including and orthogonal e g any degree shearing etc you will have to use the included reslice_nii m program to reslice the image volume reslice_nii m is not called by any other and you have to run reslice_nii m explicitly for those NIfTI files that you want to reslice them Since xform_nii m does not involve any interpolation or any slice the original image volume is supposed to be although it is translated</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00009">xform_nii.m:9</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a1f3fb972d2721a5ebac11058d4a3228f"><div class="ttname"><a href="xform__nii_8m.html#a1f3fb972d2721a5ebac11058d4a3228f">det</a></div><div class="ttdeci">if det(R)</div></div>
<div class="ttc" id="xform__nii_8m_html_a40d1b807f01e4896b3281cc7b7277300"><div class="ttname"><a href="xform__nii_8m.html#a40d1b807f01e4896b3281cc7b7277300">flip_orient</a></div><div class="ttdeci">nii hdr hist flip_orient</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00148">xform_nii.m:148</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a9fa650ab4f9794082e0915dfa7306d8f"><div class="ttname"><a href="xform__nii_8m.html#a9fa650ab4f9794082e0915dfa7306d8f">pixdim</a></div><div class="ttdeci">end hdr dime pixdim</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00469">xform_nii.m:469</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a209706a3986f2715bddabe919088e00e"><div class="ttname"><a href="xform__nii_8m.html#a209706a3986f2715bddabe919088e00e">dim</a></div><div class="ttdeci">hdr dime dim([2:4])</div></div>
<div class="ttc" id="xform__nii_8m_html_a13f682352dafa4d40a7ae9ed801e96e6"><div class="ttname"><a href="xform__nii_8m.html#a13f682352dafa4d40a7ae9ed801e96e6">micrometer</a></div><div class="ttdeci">micrometer</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00506">xform_nii.m:506</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a10a0f35066079abd150539d0d13dbf3e"><div class="ttname"><a href="xform__nii_8m.html#a10a0f35066079abd150539d0d13dbf3e">msg</a></div><div class="ttdeci">msg</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00335">xform_nii.m:335</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a7eb778c471c5522fe3f4b7ebdc4c0760"><div class="ttname"><a href="xform__nii_8m.html#a7eb778c471c5522fe3f4b7ebdc4c0760">pattern</a></div><div class="ttdeci">else pattern</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00167">xform_nii.m:167</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a9b871d477ed7a0a4dfe8ab1fc037091b"><div class="ttname"><a href="xform__nii_8m.html#a9b871d477ed7a0a4dfe8ab1fc037091b">as</a></div><div class="ttdeci">Jeff end if scl_slope field is then each voxel value in the dataset should be scaled as</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00078">xform_nii.m:78</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a541df6bf052f2efc7a949725e1c247f6"><div class="ttname"><a href="xform__nii_8m.html#a541df6bf052f2efc7a949725e1c247f6">datatype</a></div><div class="ttdeci">if nii hdr dime datatype</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00089">xform_nii.m:89</a></div></div>
<div class="ttc" id="xform__nii_8m_html_adc468c70fb574ebd07287b38d0d0676d"><div class="ttname"><a href="xform__nii_8m.html#adc468c70fb574ebd07287b38d0d0676d">k</a></div><div class="ttdeci">k</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00373">xform_nii.m:373</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a5389c938d8f439f89bc6549e6a18285d"><div class="ttname"><a href="xform__nii_8m.html#a5389c938d8f439f89bc6549e6a18285d">e</a></div><div class="ttdeci">hdr.dime.xyzt_units, 7 e()</div></div>
<div class="ttc" id="xform__nii_8m_html_a2890ce3bb7be1e5fd7e9aa65b58a2925"><div class="ttname"><a href="xform__nii_8m.html#a2890ce3bb7be1e5fd7e9aa65b58a2925">not</a></div><div class="ttdeci">end apply space_unit to pixdim if not(mm)%space_unit</div></div>
<div class="ttc" id="xform__nii_8m_html_a00722bd5d40e2aa5f56dccfa875645a0"><div class="ttname"><a href="xform__nii_8m.html#a00722bd5d40e2aa5f56dccfa875645a0">m</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii m</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00003">xform_nii.m:3</a></div></div>
<div class="ttc" id="xform__nii_8m_html_acfd440223f806c44323dbd1053b99123"><div class="ttname"><a href="xform__nii_8m.html#acfd440223f806c44323dbd1053b99123">second</a></div><div class="ttdeci">second</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00517">xform_nii.m:517</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a3dfb20bb83a99a0ca0755ef56b1fd4a9"><div class="ttname"><a href="xform__nii_8m.html#a3dfb20bb83a99a0ca0755ef56b1fd4a9">R_sort</a></div><div class="ttdeci">R_sort</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00329">xform_nii.m:329</a></div></div>
<div class="ttc" id="xform__nii_8m_html_abf2bc2545a4a5f5683d9ef3ed0d977e0"><div class="ttname"><a href="xform__nii_8m.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a></div><div class="ttdeci">j</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00372">xform_nii.m:372</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_aa82e6383b921cf10c8e48000127ff7dc"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#aa82e6383b921cf10c8e48000127ff7dc">figure</a></div><div class="ttdeci">figure</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00052">hellier_hist_normalization_gmm.m:52</a></div></div>
<div class="ttc" id="xform__nii_8m_html_afa9804529d0f2f5215cb7f51e8bff526"><div class="ttname"><a href="xform__nii_8m.html#afa9804529d0f2f5215cb7f51e8bff526">time_unit</a></div><div class="ttdeci">ms case time_unit</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00515">xform_nii.m:515</a></div></div>
<div class="ttc" id="reslice__nii_8m_html_a7a252e0f4bf7885d8d4789b1b1066aab"><div class="ttname"><a href="reslice__nii_8m.html#a7a252e0f4bf7885d8d4789b1b1066aab">old_affine</a></div><div class="ttdeci">nii hdr hist old_affine</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00212">reslice_nii.m:212</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a969b424c4d5ee8841704d2c431950747"><div class="ttname"><a href="xform__nii_8m.html#a969b424c4d5ee8841704d2c431950747">qfac</a></div><div class="ttdeci">end qfac</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00369">xform_nii.m:369</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a4068c1b4f259ced4d5ad4c6762c715eb"><div class="ttname"><a href="xform__nii_8m.html#a4068c1b4f259ced4d5ad4c6762c715eb">millimeter</a></div><div class="ttdeci">set space_unit of xyzt_units to millimeter</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00461">xform_nii.m:461</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a6f6ccfcf58b31cb6412107d9d5281426"><div class="ttname"><a href="xform__nii_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div><div class="ttdeci">for i</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00182">xform_nii.m:182</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ade6e498f1ab724790b30502a59c7d186"><div class="ttname"><a href="xform__nii_8m.html#ade6e498f1ab724790b30502a59c7d186">space_unit</a></div><div class="ttdeci">if space_unit</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00458">xform_nii.m:458</a></div></div>
<div class="ttc" id="reslice__nii_8m_html_a5f512d455013d953e6018dee349e78f6"><div class="ttname"><a href="reslice__nii_8m.html#a5f512d455013d953e6018dee349e78f6">else</a></div><div class="ttdeci">end else[img M]</div><div class="ttdef"><b>Definition:</b> <a href="reslice__nii_8m_source.html#l00109">reslice_nii.m:109</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ab817851e1ff98f713358ea03223cf91d"><div class="ttname"><a href="xform__nii_8m.html#ab817851e1ff98f713358ea03223cf91d">tmp</a></div><div class="ttdeci">tmp</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00207">xform_nii.m:207</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ab74f5431bce53baaa41c0e31666c7363"><div class="ttname"><a href="xform__nii_8m.html#ab74f5431bce53baaa41c0e31666c7363">affine_transform</a></div><div class="ttdeci">affine_transform</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00276">xform_nii.m:276</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ab731fd3d331f10ec6151c2897aed450a"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ab731fd3d331f10ec6151c2897aed450a">hist</a></div><div class="ttdeci">hist(cleaned_converted_data, max_value)</div></div>
<div class="ttc" id="xform__nii_8m_html_aee34f1464f1bbd47259504a32b8639f5"><div class="ttname"><a href="xform__nii_8m.html#aee34f1464f1bbd47259504a32b8639f5">new_dim</a></div><div class="ttdeci">new_dim</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00196">xform_nii.m:196</a></div></div>
<div class="ttc" id="xform__nii_8m_html_adf1f3edb9115acb0a1e04209b7a9937b"><div class="ttname"><a href="xform__nii_8m.html#adf1f3edb9115acb0a1e04209b7a9937b">T</a></div><div class="ttdeci">T</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00138">xform_nii.m:138</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a8e15b42ec8048cd948e07f776628ac2d"><div class="ttname"><a href="xform__nii_8m.html#a8e15b42ec8048cd948e07f776628ac2d">error</a></div><div class="ttdeci">Jeff if error('User requires sform, sform not set in header')</div></div>
<div class="ttc" id="xform__nii_8m_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="xform__nii_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00356">xform_nii.m:356</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a6c2f4e523c936b7725a67fb12691ab13"><div class="ttname"><a href="xform__nii_8m.html#a6c2f4e523c936b7725a67fb12691ab13">type</a></div><div class="ttdeci">end the scaling is to be ignored if datatype is DT_RGB24 If datatype is a complex type</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00109">xform_nii.m:109</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a2b76768e294588fbdaf82b55a8273f6a"><div class="ttname"><a href="xform__nii_8m.html#a2b76768e294588fbdaf82b55a8273f6a">xyzt_units</a></div><div class="ttdeci">hdr dime xyzt_units</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00465">xform_nii.m:465</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ac1f63242dd36df9da920d8a23ad5c84c"><div class="ttname"><a href="xform__nii_8m.html#ac1f63242dd36df9da920d8a23ad5c84c">scl_slope</a></div><div class="ttdeci">Jeff end if scl_slope field is then each voxel value in the dataset should be scaled &amp;nii hdr dime scl_slope</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00084">xform_nii.m:84</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ad07d284a896de58ddcaa088799d032c7"><div class="ttname"><a href="xform__nii_8m.html#ad07d284a896de58ddcaa088799d032c7">glmax</a></div><div class="ttdeci">end nii hdr dime glmax</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00100">xform_nii.m:100</a></div></div>
<div class="ttc" id="xform__nii_8m_html_aacacf50c8b45a3f09dbd6b2dd5a21bf6"><div class="ttname"><a href="xform__nii_8m.html#aacacf50c8b45a3f09dbd6b2dd5a21bf6">translation</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including translation</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00003">xform_nii.m:3</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a6b45d48125a6b8b1ee140eed24a0419f"><div class="ttname"><a href="xform__nii_8m.html#a6b45d48125a6b8b1ee140eed24a0419f">R</a></div><div class="ttdeci">old SPM affine matrix R</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00137">xform_nii.m:137</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a1ede835792071dff91c0e008e7c3b16a"><div class="ttname"><a href="xform__nii_8m.html#a1ede835792071dff91c0e008e7c3b16a">a</a></div><div class="ttdeci">end else a</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00366">xform_nii.m:366</a></div></div>
<div class="ttc" id="xform__nii_8m_html_aec73fe9e74757fd534ee3e9a7cbc8bde"><div class="ttname"><a href="xform__nii_8m.html#aec73fe9e74757fd534ee3e9a7cbc8bde">isequal</a></div><div class="ttdeci">Jeff if isequal(preferredForm,'S') if isequal(hdr.hist.sform_code</div></div>
<div class="ttc" id="xform__nii_8m_html_a3e7826f60c8b041e8f685e93902e14ee"><div class="ttname"><a href="xform__nii_8m.html#a3e7826f60c8b041e8f685e93902e14ee">rotated</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including and orthogonal e g any degree shearing etc you will have to use the included reslice_nii m program to reslice the image volume reslice_nii m is not called by any other and you have to run reslice_nii m explicitly for those NIfTI files that you want to reslice them Since xform_nii m does not involve any interpolation or any slice the original image volume is supposed to be although it is or even orthogonally rotated</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00009">xform_nii.m:9</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a5c64f97f406d865a23cef0e15368a61f"><div class="ttname"><a href="xform__nii_8m.html#a5c64f97f406d865a23cef0e15368a61f">originator</a></div><div class="ttdeci">originator</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00439">xform_nii.m:439</a></div></div>
<div class="ttc" id="save__untouch__nii_8m_html_a97ee6abe7d21ae63d3399f62a2abd639"><div class="ttname"><a href="save__untouch__nii_8m.html#a97ee6abe7d21ae63d3399f62a2abd639">case</a></div><div class="ttdeci">end switch case</div><div class="ttdef"><b>Definition:</b> <a href="save__untouch__nii_8m_source.html#l00065">save_untouch_nii.m:65</a></div></div>
<div class="ttc" id="load__untouch__nii_8m_html_a76db606ebe66b1a54d0e3425521586f4"><div class="ttname"><a href="load__untouch__nii_8m.html#a76db606ebe66b1a54d0e3425521586f4">image</a></div><div class="ttdeci">Load NIFTI or ANALYZE but not applying any appropriate affine geometric transform or voxel intensity scaling Although according to NIFTI all those header information are supposed to be applied to the loaded NIFTI image</div><div class="ttdef"><b>Definition:</b> <a href="load__untouch__nii_8m_source.html#l00001">load_untouch_nii.m:1</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a448a15a66934cebb54a54153e3fe6ba9"><div class="ttname"><a href="xform__nii_8m.html#a448a15a66934cebb54a54153e3fe6ba9">srow_z</a></div><div class="ttdeci">nii hdr hist srow_z</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00145">xform_nii.m:145</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ad14d98cdcfa4397ac3a0af6ce942c55d"><div class="ttname"><a href="xform__nii_8m.html#ad14d98cdcfa4397ac3a0af6ce942c55d">millisecond</a></div><div class="ttdeci">millisecond</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00513">xform_nii.m:513</a></div></div>
<div class="ttc" id="save__untouch__nii_8m_html_a5acb2d0a726641d28d07836ce7824f58"><div class="ttname"><a href="save__untouch__nii_8m.html#a5acb2d0a726641d28d07836ce7824f58">save</a></div><div class="ttdeci">save(fileprefix, 'M')</div></div>
<div class="ttc" id="xform__nii_8m_html_a680b8190fb01103a563c5586524b8874"><div class="ttname"><a href="xform__nii_8m.html#a680b8190fb01103a563c5586524b8874">program</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including and orthogonal e g any degree shearing etc you will have to use the included reslice_nii m program to reslice the image volume reslice_nii m is not called by any other program</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00009">xform_nii.m:9</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ab514b5f78b1accaf0754f4c70dbb21a1"><div class="ttname"><a href="xform__nii_8m.html#ab514b5f78b1accaf0754f4c70dbb21a1">transforms</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine transforms</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00003">xform_nii.m:3</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a31b09554be925689c61bdaf06c7e6773"><div class="ttname"><a href="xform__nii_8m.html#a31b09554be925689c61bdaf06c7e6773">rotation</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including and orthogonal e g any degree rotation</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00009">xform_nii.m:9</a></div></div>
<div class="ttc" id="load__untouch__nii_8m_html_ac238b270f83f7fdcb757309812fa28c5"><div class="ttname"><a href="load__untouch__nii_8m.html#ac238b270f83f7fdcb757309812fa28c5">dataset</a></div><div class="ttdeci">Load NIFTI or ANALYZE dataset</div><div class="ttdef"><b>Definition:</b> <a href="load__untouch__nii_8m_source.html#l00001">load_untouch_nii.m:1</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a436f30a0a0000d67d5c56b6e36a2a606"><div class="ttname"><a href="xform__nii_8m.html#a436f30a0a0000d67d5c56b6e36a2a606">change</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including and orthogonal e g any degree shearing etc you will have to use the included reslice_nii m program to reslice the image volume reslice_nii m is not called by any other and you have to run reslice_nii m explicitly for those NIfTI files that you want to reslice them Since xform_nii m does not involve any interpolation or any slice change</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00009">xform_nii.m:9</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ac1dee459aca75cb3082c5d6534aa74ef"><div class="ttname"><a href="xform__nii_8m.html#ac1dee459aca75cb3082c5d6534aa74ef">flip</a></div><div class="ttdeci">do flip</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00180">xform_nii.m:180</a></div></div>
<div class="ttc" id="xform__nii_8m_html_afdf31327ed81468d66cf6bf1ab1a9e2a"><div class="ttname"><a href="xform__nii_8m.html#afdf31327ed81468d66cf6bf1ab1a9e2a">glmin</a></div><div class="ttdeci">nii hdr dime glmin</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00101">xform_nii.m:101</a></div></div>
<div class="ttc" id="xform__nii_8m_html_aec46df66b2e4c26c5340d523471db40f"><div class="ttname"><a href="xform__nii_8m.html#aec46df66b2e4c26c5340d523471db40f">microsecond</a></div><div class="ttdeci">microsecond</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00515">xform_nii.m:515</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a319684c14641b1e61c5abf9fa5888b97"><div class="ttname"><a href="xform__nii_8m.html#a319684c14641b1e61c5abf9fa5888b97">qform_code</a></div><div class="ttdeci">nii hdr hist qform_code</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00141">xform_nii.m:141</a></div></div>
<div class="ttc" id="load__untouch__nii_8m_html_a5381cdd79f39b45eb8550689cc700aac"><div class="ttname"><a href="load__untouch__nii_8m.html#a5381cdd79f39b45eb8550689cc700aac">header</a></div><div class="ttdeci">end Read the dataset header[nii.hdr, nii.filetype, nii.fileprefix, nii.machine]</div><div class="ttdef"><b>Definition:</b> <a href="load__untouch__nii_8m_source.html#l00103">load_untouch_nii.m:103</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a5cb6f57e0e8b329c031b64c318559426"><div class="ttname"><a href="xform__nii_8m.html#a5cb6f57e0e8b329c031b64c318559426">qform</a></div><div class="ttdeci">values are Q Lower case q indicate prefer sform or qform</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00051">xform_nii.m:51</a></div></div>
<div class="ttc" id="emgm_8m_html_a67531ee5e31b1d1a3065cf637eae4546"><div class="ttname"><a href="emgm_8m.html#a67531ee5e31b1d1a3065cf637eae4546">function</a></div><div class="ttdeci">function[label, model, llh]</div><div class="ttdef"><b>Definition:</b> <a href="emgm_8m_source.html#l00001">emgm.m:1</a></div></div>
<div class="ttc" id="xform__nii_8m_html_afaec44be68b4dd7d69cd18070f541993"><div class="ttname"><a href="xform__nii_8m.html#afaec44be68b4dd7d69cd18070f541993">srow_x</a></div><div class="ttdeci">nii hdr hist srow_x</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00143">xform_nii.m:143</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ae9a659ee1c9ae19c4f8c8c8c9aa072c0"><div class="ttname"><a href="xform__nii_8m.html#ae9a659ee1c9ae19c4f8c8c8c9aa072c0">bitpix</a></div><div class="ttdeci">nii hdr dime bitpix</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00092">xform_nii.m:92</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a0e59908ff00ce07861ead56d41e8e8b3"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a0e59908ff00ce07861ead56d41e8e8b3">and</a></div><div class="ttdeci">absolute max value DATA DEPENDENT PARAMENTER Not extremely critical but they need to be the data are normalized between and</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00031">hellier_hist_normalization_gmm.m:31</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ad23889dc5dd027154839396ddeb4343c"><div class="ttname"><a href="xform__nii_8m.html#ad23889dc5dd027154839396ddeb4343c">new_affine</a></div><div class="ttdeci">hdr hist new_affine</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00331">xform_nii.m:331</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a81e12916b4d3e68242f0ac25c3ff1035"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a81e12916b4d3e68242f0ac25c3ff1035">NOTE</a></div><div class="ttdeci">A Crimi Histogram standardization Nyul et al GMM version of Pierre Hellier The general idea is to strech a target histogram according to the mode and shoulder of a template histogram MRI data is set the mode of the shoulder to use as the WhiteMatter mode NOTE</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00009">hellier_hist_normalization_gmm.m:9</a></div></div>
<div class="ttc" id="xform__nii_8m_html_aacab4845605c8da426d11f687fabeabe"><div class="ttname"><a href="xform__nii_8m.html#aacab4845605c8da426d11f687fabeabe">ndims</a></div><div class="ttdeci">More than time frame if ndims(nii.img) &gt; 3 pattern</div></div>
<div class="ttc" id="xform__nii_8m_html_a1dcbb39086f836d3198af29ebab02004"><div class="ttname"><a href="xform__nii_8m.html#a1dcbb39086f836d3198af29ebab02004">mm</a></div><div class="ttdeci">we ll make sure that happens now we make the same checks as were done above for sform data BUT we do it on a transform that is in terms of voxels not mm</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00387">xform_nii.m:387</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_ae1faaa3fedc82a59c523a5f60b2e900f"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#ae1faaa3fedc82a59c523a5f60b2e900f">means</a></div><div class="ttdeci">Check the order of the means</div><div class="ttdef"><b>Definition:</b> <a href="hellier__hist__normalization__gmm_8m_source.html#l00058">hellier_hist_normalization_gmm.m:58</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ab532f211a59e750f5f2657bc5e2172ab"><div class="ttname"><a href="xform__nii_8m.html#ab532f211a59e750f5f2657bc5e2172ab">that</a></div><div class="ttdeci">after we figure out the angles and squash them to closest rectilinear direction After that</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00389">xform_nii.m:389</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a340b9e1a6a0f19cb437a822e83622181"><div class="ttname"><a href="xform__nii_8m.html#a340b9e1a6a0f19cb437a822e83622181">bitand</a></div><div class="ttdeci">mm end switch bitand(hdr.dime.xyzt_units, 56)%mask with 0x38 case 16 time_unit</div></div>
<div class="ttc" id="emgm_8m_html_aaccc9105df5383111407fd5b41255e23"><div class="ttname"><a href="emgm_8m.html#aaccc9105df5383111407fd5b41255e23">t</a></div><div class="ttdeci">t</div><div class="ttdef"><b>Definition:</b> <a href="emgm_8m_source.html#l00018">emgm.m:18</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a35e6130bb6ae8c0bbc86ae3e894b4222"><div class="ttname"><a href="xform__nii_8m.html#a35e6130bb6ae8c0bbc86ae3e894b4222">transform</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine transform</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00003">xform_nii.m:3</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a087945111b3aa49887b612fc0a24a870"><div class="ttname"><a href="xform__nii_8m.html#a087945111b3aa49887b612fc0a24a870">reflected</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including and orthogonal e g any degree shearing etc you will have to use the included reslice_nii m program to reslice the image volume reslice_nii m is not called by any other and you have to run reslice_nii m explicitly for those NIfTI files that you want to reslice them Since xform_nii m does not involve any interpolation or any slice the original image volume is supposed to be although it is reflected</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00009">xform_nii.m:9</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a74f9730f486be70373c812d488936dc9"><div class="ttname"><a href="xform__nii_8m.html#a74f9730f486be70373c812d488936dc9">hdr</a></div><div class="ttdeci">no sform qform for Analyze format end hdr</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00152">xform_nii.m:152</a></div></div>
<div class="ttc" id="xform__nii_8m_html_afc699248477dde48350fe94448b89504"><div class="ttname"><a href="xform__nii_8m.html#afc699248477dde48350fe94448b89504">new_pixdim</a></div><div class="ttdeci">new_pixdim</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00200">xform_nii.m:200</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a1aabac6d068eef6a7bad3fdf50a05cc8"><div class="ttname"><a href="xform__nii_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a></div><div class="ttdeci">d</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00357">xform_nii.m:357</a></div></div>
<div class="ttc" id="load__nii__ext_8m_html_aff247e90c6608215c92679f8aa390e10"><div class="ttname"><a href="load__nii__ext_8m.html#aff247e90c6608215c92679f8aa390e10">fileprefix</a></div><div class="ttdeci">fileprefix</div><div class="ttdef"><b>Definition:</b> <a href="load__nii__ext_8m_source.html#l00030">load_nii_ext.m:30</a></div></div>
<div class="ttc" id="xform__nii_8m_html_afe106eb99aa948b70ba9ff453d1cde80"><div class="ttname"><a href="xform__nii_8m.html#afe106eb99aa948b70ba9ff453d1cde80">S</a></div><div class="ttdeci">values are S</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00051">xform_nii.m:51</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_a4797586c9f191ec7ffd84e764c4c54e7"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#a4797586c9f191ec7ffd84e764c4c54e7">for</a></div><div class="ttdeci">for(jj=1:length(first_subset)) if(first_subset(jj)&lt; mu_i_first_subset) standardized_hist(jj)</div></div>
<div class="ttc" id="xform__nii_8m_html_a9fa90427dcfbd3842b66764f038bcbeb"><div class="ttname"><a href="xform__nii_8m.html#a9fa90427dcfbd3842b66764f038bcbeb">nonzero</a></div><div class="ttdeci">Jeff end if scl_slope field is nonzero</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00078">xform_nii.m:78</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ae587f42cdc9c46cb65f6e56680d747a8"><div class="ttname"><a href="xform__nii_8m.html#ae587f42cdc9c46cb65f6e56680d747a8">straight</a></div><div class="ttdeci">if that is straight(not oblique) then it should be the same as%columnwise summation.Could just as well have checked the%lengths of R(find(R)) and sum(R)'(which should be 3)%hdr.hist.old_affine</div></div>
<div class="ttc" id="xform__nii_8m_html_a20e1746bf8fab881987958cd24f9cf6f"><div class="ttname"><a href="xform__nii_8m.html#a20e1746bf8fab881987958cd24f9cf6f">return</a></div><div class="ttdeci">return</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00149">xform_nii.m:149</a></div></div>
<div class="ttc" id="xform__nii_8m_html_add7e617330774ae8bc6b4cd8c67b65b4"><div class="ttname"><a href="xform__nii_8m.html#add7e617330774ae8bc6b4cd8c67b65b4">M</a></div><div class="ttdeci">M(1:3, 4)</div></div>
<div class="ttc" id="xform__nii_8m_html_afd6ce22ae5ea522c4e91b48d6d72c195"><div class="ttname"><a href="xform__nii_8m.html#afd6ce22ae5ea522c4e91b48d6d72c195">rot_orient</a></div><div class="ttdeci">end calculate for rotation after flip rot_orient</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00176">xform_nii.m:176</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a402668afa73f28e7643901afacaeca4c"><div class="ttname"><a href="xform__nii_8m.html#a402668afa73f28e7643901afacaeca4c">q</a></div><div class="ttdeci">values are q</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00051">xform_nii.m:51</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a070fea3895f133851ed0ea4599f52886"><div class="ttname"><a href="xform__nii_8m.html#a070fea3895f133851ed0ea4599f52886">However</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including and orthogonal e g any degree shearing etc you will have to use the included reslice_nii m program to reslice the image volume reslice_nii m is not called by any other and you have to run reslice_nii m explicitly for those NIfTI files that you want to reslice them Since xform_nii m does not involve any interpolation or any slice the original image volume is supposed to be although it is or even orthogonally based on the affine matrix in the NIfTI header However</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00009">xform_nii.m:9</a></div></div>
<div class="ttc" id="load__untouch__nii_8m_html_ad687cafb469fa0ea5f34a64e7eb84ec5"><div class="ttname"><a href="load__untouch__nii_8m.html#ad687cafb469fa0ea5f34a64e7eb84ec5">nii</a></div><div class="ttdeci">Perform some of sform qform transform nii</div><div class="ttdef"><b>Definition:</b> <a href="load__untouch__nii_8m_source.html#l00123">load_untouch_nii.m:123</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a1af5497f0d80ec2d3e57945765f73d8c"><div class="ttname"><a href="xform__nii_8m.html#a1af5497f0d80ec2d3e57945765f73d8c">s</a></div><div class="ttdeci">values are s</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00051">xform_nii.m:51</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ab2ffebffc4896f5e6e6d3582ced1fbd9"><div class="ttname"><a href="xform__nii_8m.html#ab2ffebffc4896f5e6e6d3582ced1fbd9">preferredForm</a></div><div class="ttdeci">NIFTI can have both sform and qform transform This program will check sform_code prior to qform_code by default If user specifys preferredForm</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00281">xform_nii.m:281</a></div></div>
<div class="ttc" id="xform__nii_8m_html_aa482cfed4344666db363eea1adf51427"><div class="ttname"><a href="xform__nii_8m.html#aa482cfed4344666db363eea1adf51427">untouched</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including and orthogonal e g any degree shearing etc you will have to use the included reslice_nii m program to reslice the image volume reslice_nii m is not called by any other and you have to run reslice_nii m explicitly for those NIfTI files that you want to reslice them Since xform_nii m does not involve any interpolation or any slice the original image volume is supposed to be untouched</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00009">xform_nii.m:9</a></div></div>
<div class="ttc" id="xform__nii_8m_html_aa602d694ac4a8ed675ce4f3fd3373c6c"><div class="ttname"><a href="xform__nii_8m.html#aa602d694ac4a8ed675ce4f3fd3373c6c">reflection</a></div><div class="ttdeci">internal function xform_nii m is an internal function called by load_nii so you do not need run this program by yourself It does simplified NIfTI sform qform affine and supports some of the affine including reflection</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00003">xform_nii.m:3</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a60fced9075c57d0553766459f9138570"><div class="ttname"><a href="xform__nii_8m.html#a60fced9075c57d0553766459f9138570">~exist</a></div><div class="ttdeci">if ~exist('tolerance','var')|isempty(tolerance) tolerance=0.1</div></div>
<div class="ttc" id="xform__nii_8m_html_adc359efc23ea39d0411c481c3123f64b"><div class="ttname"><a href="xform__nii_8m.html#adc359efc23ea39d0411c481c3123f64b">img</a></div><div class="ttdeci">else nii img</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00094">xform_nii.m:94</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a7a6151189c42255ed2727c0c65bd8860"><div class="ttname"><a href="xform__nii_8m.html#a7a6151189c42255ed2727c0c65bd8860">filetype</a></div><div class="ttdeci">end There is no need for this program to transform Analyze data if nii filetype</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00135">xform_nii.m:135</a></div></div>
<div class="ttc" id="hellier__hist__normalization__gmm_8m_html_aee68761b6ed79a43586f5dc87638d130"><div class="ttname"><a href="hellier__hist__normalization__gmm_8m.html#aee68761b6ed79a43586f5dc87638d130">load_untouch_nii</a></div><div class="ttdeci">file_mask_template load_untouch_nii()</div></div>
<div class="ttc" id="xform__nii_8m_html_a83e89a30b9d250f312ba7c0ee122ead8"><div class="ttname"><a href="xform__nii_8m.html#a83e89a30b9d250f312ba7c0ee122ead8">srow_y</a></div><div class="ttdeci">nii hdr hist srow_y</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00144">xform_nii.m:144</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a7faa578ac30a502075bbd6528ca570a8"><div class="ttname"><a href="xform__nii_8m.html#a7faa578ac30a502075bbd6528ca570a8">sform_code</a></div><div class="ttdeci">nii hdr hist sform_code</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00142">xform_nii.m:142</a></div></div>
<div class="ttc" id="xform__nii_8m_html_a3e2df7a11ee5b0b768b870c65b42e33f"><div class="ttname"><a href="xform__nii_8m.html#a3e2df7a11ee5b0b768b870c65b42e33f">orient</a></div><div class="ttdeci">orient</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00440">xform_nii.m:440</a></div></div>
<div class="ttc" id="xform__nii_8m_html_af029974ae4b9824ec0773756fab0f47a"><div class="ttname"><a href="xform__nii_8m.html#af029974ae4b9824ec0773756fab0f47a">meter</a></div><div class="ttdeci">meter</div><div class="ttdef"><b>Definition:</b> <a href="xform__nii_8m_source.html#l00504">xform_nii.m:504</a></div></div>
<div class="ttc" id="load__untouch__nii_8m_html_ad601cae513dcbc91f7b5ccb0101bac22"><div class="ttname"><a href="load__untouch__nii_8m.html#ad601cae513dcbc91f7b5ccb0101bac22">orientation</a></div><div class="ttdeci">Load NIFTI or ANALYZE but not applying any appropriate affine geometric transform or voxel intensity scaling Although according to NIFTI all those header information are supposed to be applied to the loaded NIFTI there are some situations that people do want to leave the original NIFTI header and data untouched They will probably just use MATLAB to do certain image processing regardless of image orientation</div><div class="ttdef"><b>Definition:</b> <a href="load__untouch__nii_8m_source.html#l00001">load_untouch_nii.m:1</a></div></div>
<div class="ttc" id="xform__nii_8m_html_ac6bc8350140b19d063e04417eeab8230"><div class="ttname"><a href="xform__nii_8m.html#ac6bc8350140b19d063e04417eeab8230">elseif</a></div><div class="ttdeci">elseif(tolerance&lt;=0) tolerance</div></div>
<div class="ttc" id="load__nii__img_8m_html_a0e58fe5bf1f468ebd8ae6b3620a52472"><div class="ttname"><a href="load__nii__img_8m.html#a0e58fe5bf1f468ebd8ae6b3620a52472">end</a></div><div class="ttdeci">end end[img, hdr]</div><div class="ttdef"><b>Definition:</b> <a href="load__nii__img_8m_source.html#l00115">load_nii_img.m:115</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 11 2014 15:55:50 for ANIMA by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
